<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.299">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gezhi Chen">

<title>Macroeconometrics Research Report - Inflation Insight: Forecasting Australian Inflation Rate Using Bayesian VAR model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#question-objective-and-motivation" id="toc-question-objective-and-motivation" class="nav-link" data-scroll-target="#question-objective-and-motivation"><span class="header-section-number">1.1</span> Question Objective and Motivation</a></li>
  </ul></li>
  <li><a href="#data-and-data-properties" id="toc-data-and-data-properties" class="nav-link" data-scroll-target="#data-and-data-properties"><span class="header-section-number">2</span> Data and Data Properties</a>
  <ul class="collapse">
  <li><a href="#data-selection-and-rationale" id="toc-data-selection-and-rationale" class="nav-link" data-scroll-target="#data-selection-and-rationale"><span class="header-section-number">2.1</span> Data Selection and Rationale</a></li>
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation"><span class="header-section-number">2.2</span> Data Transformation</a></li>
  <li><a href="#importance-of-key-variables-analysis" id="toc-importance-of-key-variables-analysis" class="nav-link" data-scroll-target="#importance-of-key-variables-analysis"><span class="header-section-number">2.3</span> Importance of Key Variables Analysis</a></li>
  </ul></li>
  <li><a href="#model-and-hypothesis" id="toc-model-and-hypothesis" class="nav-link" data-scroll-target="#model-and-hypothesis"><span class="header-section-number">3</span> Model and Hypothesis</a>
  <ul class="collapse">
  <li><a href="#model-application-and-objective-fulfillment" id="toc-model-application-and-objective-fulfillment" class="nav-link" data-scroll-target="#model-application-and-objective-fulfillment"><span class="header-section-number">3.1</span> Model Application and Objective Fulfillment</a></li>
  </ul></li>
  <li><a href="#estimation-procedure-and-algorithm" id="toc-estimation-procedure-and-algorithm" class="nav-link" data-scroll-target="#estimation-procedure-and-algorithm"><span class="header-section-number">4</span> Estimation Procedure and Algorithm</a>
  <ul class="collapse">
  <li><a href="#basic-model" id="toc-basic-model" class="nav-link" data-scroll-target="#basic-model"><span class="header-section-number">4.1</span> Basic Model</a></li>
  <li><a href="#extended-model" id="toc-extended-model" class="nav-link" data-scroll-target="#extended-model"><span class="header-section-number">4.2</span> Extended Model</a></li>
  </ul></li>
  <li><a href="#empirical-analysis---model-applying-and-forecasing" id="toc-empirical-analysis---model-applying-and-forecasing" class="nav-link" data-scroll-target="#empirical-analysis---model-applying-and-forecasing"><span class="header-section-number">5</span> Empirical Analysis - Model Applying and Forecasing</a>
  <ul class="collapse">
  <li><a href="#basic-model-1" id="toc-basic-model-1" class="nav-link" data-scroll-target="#basic-model-1"><span class="header-section-number">5.1</span> Basic Model</a></li>
  <li><a href="#extended-model-1" id="toc-extended-model-1" class="nav-link" data-scroll-target="#extended-model-1"><span class="header-section-number">5.2</span> Extended Model</a></li>
  <li><a href="#asides---different-priors-and-assumptions" id="toc-asides---different-priors-and-assumptions" class="nav-link" data-scroll-target="#asides---different-priors-and-assumptions"><span class="header-section-number">5.3</span> Asides - Different Priors and Assumptions</a></li>
  </ul></li>
  <li><a href="#stochastic-volatility-conditional-heteroskedasticity" id="toc-stochastic-volatility-conditional-heteroskedasticity" class="nav-link" data-scroll-target="#stochastic-volatility-conditional-heteroskedasticity"><span class="header-section-number">6</span> Stochastic Volatility Conditional Heteroskedasticity</a>
  <ul class="collapse">
  <li><a href="#basic-model-with-heteroskedasticity" id="toc-basic-model-with-heteroskedasticity" class="nav-link" data-scroll-target="#basic-model-with-heteroskedasticity"><span class="header-section-number">6.1</span> Basic Model with Heteroskedasticity</a></li>
  <li><a href="#extended-model-with-heteroskedasticity" id="toc-extended-model-with-heteroskedasticity" class="nav-link" data-scroll-target="#extended-model-with-heteroskedasticity"><span class="header-section-number">6.2</span> Extended Model with Heteroskedasticity</a></li>
  <li><a href="#heteroskadasticity-analysis" id="toc-heteroskadasticity-analysis" class="nav-link" data-scroll-target="#heteroskadasticity-analysis"><span class="header-section-number">6.3</span> Heteroskadasticity Analysis</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">7</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Inflation Insight: Forecasting Australian Inflation Rate Using Bayesian VAR model</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gezhi Chen </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>Abstract.</strong> The purpose of this research is to explore the trend in Australia’s inflation rate over the next two years using the Bayesian Vector Auto-regression (BVAR) model. This study aims to provide a comprehensive analysis of inflation dynamics using advanced econometric techniques to forecast future trends. By applying the BVAR model, which incorporates both Bayesian statistical methods and vector auto-regression, evaluates various specifications of the BVAR model, including different priors and assumptions about the volatility of economic indicators.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Keywords.</strong> bsvars, quarto, R, Australia inflation rate</p>
</blockquote>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<section id="question-objective-and-motivation" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="question-objective-and-motivation"><span class="header-section-number">1.1</span> Question Objective and Motivation</h3>
<p><strong>Question:</strong></p>
<p>Will Australia’s inflation rate fall back to the 2-3% inflation target range in 2025?</p>
<p><strong>Objective and Motivation:</strong></p>
<p>Inflation has always been a topic of interest for economists, as trends in the inflation rate provide essential guidance for key decisions by economic participants, thus playing a crucial role in the economic and social development of a country <span class="citation" data-cites="bernoth2021">(<a href="#ref-bernoth2021" role="doc-biblioref">Bernoth and Ider 2021</a>)</span>. The Reserve Bank of Australia (RBA) forecasts that by 2025, inflation will fall back to the target range of 2% to 3% and reach the midpoint of this range by 2026. Influenced by the COVID-19 pandemic, Blot et al.&nbsp;deduced that the inflation rate is affected by a variety of factors, such as GDP, exchange rates, interest rates, and unemployment rates <span class="citation" data-cites="EuropeanParliament.2022">(<a href="#ref-EuropeanParliament.2022" role="doc-biblioref">European Parliament. Directorate General for Internal Policies of the Union. 2022</a>)</span>. Therefore, this study will assess the reasonableness of the RBA’s inflation rate forecast for the next two years. During the COVID-19 period, Australia’s inflation rate sharply rose to 7.8%, in response to which the RBA implemented a monetary tightening policy and began raising interest rates at the end of 2022, slowing the pace of rate hikes in the latter half of 2023. Hence, this report will further discuss whether the RBA has correctly assumed that its monetary policy measures have effectively curbed inflation.</p>
</section>
</section>
<section id="data-and-data-properties" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="data-and-data-properties"><span class="header-section-number">2</span> Data and Data Properties</h2>
<section id="data-selection-and-rationale" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="data-selection-and-rationale"><span class="header-section-number">2.1</span> Data Selection and Rationale</h3>
<ul>
<li><p><strong>Direct Inflationary Indicators:</strong></p>
<p>1.<span class="math inline">\(cpi_t\)</span>: Consumer Price Index (CPI) from ABS.</p>
<p>CPI directly measure inflation by follow formula:</p>
<p><span id="eq-1"><span class="math display">\[Inflation  = (\frac{CPI_{Quarter \ of \ These \ Year}}{CPI_{Quarter \ of \ Previous \ Year} } - 1 )\times 100 \tag{1}\]</span></span></p>
<p>CPI is the basic data for measuring inflation. It is more stable and less affected by seasonal factors and short-term fluctuations than the annual inflation rate from which it is derived. In VAR, raw time series data rather than rates of change are used to capture and model the dynamic nature of the data.</p>
<p>2.<span class="math inline">\(infexp_t\)</span>: Business inflation expectations – 3-months ahead from RBA</p>
<p>Inflation expectations often guide consumer and business behavior; if inflation is expected to rise, they might make purchases and raise prices in advance, thus driving actual inflation up in the short term. Meanwhile, central banks closely monitor inflation expectations, adjusting monetary policies to influence these expectations and control actual inflation to maintain price stability.</p></li>
<li><p><strong>Economic Activity and Policy Indicators:</strong></p>
<ol start="3" type="1">
<li><span class="math inline">\(gdp_t\)</span>: Gross Domestic Product (GDP) from ABS.</li>
</ol>
<p>GDP reflects the size and growth rate of a country’s economy. When GDP increases, it indicates increased economic activity, which can lead to demand-pull inflation because increased demand may exceed current production capacity, pushing up prices.</p>
<ol start="4" type="1">
<li><span class="math inline">\(crt_t\)</span>: Cash rate target published by RBA.</li>
</ol>
<p>This is the main tool used by the RBA to influence economic activity. Raising the cash rate is usually aimed at reducing borrowing and spending, thereby reducing inflationary pressures.</p>
<ol start="5" type="1">
<li><span class="math inline">\(unemp_t\)</span>: Unemployment rate from ABS.</li>
</ol>
<p>It indicate the level of slack in the labor market, influencing wage-push inflation.</p>
<ol start="6" type="1">
<li><span class="math inline">\(m_t\)</span>: Money aggregate (Broad money) from RBA.</li>
</ol>
<p>‘Broad money’ is defined as ‘M3’ plus ‘Other borrowings from private sector by AFIs’. When the growth rate of broad money supply in an economy exceeds the growth rate of its real output, it leads to more money chasing the same amount of goods and services, causing price levels to rise, i.e., inflation. Therefore, central banks like the Reserve Bank of Australia (RBA) adjust interest rates and other tools to control the growth of broad money to achieve their inflation targets.</p></li>
<li><p><strong>Market and External Trade Indicators:</strong></p>
<ol start="7" type="1">
<li><span class="math inline">\(export_t\)</span>: International exports from ABS.</li>
</ol>
<p>It affects trade balance and currency strength, influencing imported inflation.</p>
<ol start="8" type="1">
<li><span class="math inline">\(import_t\)</span>: International imports from ABS.</li>
</ol>
<p>Directly affect inflation through the cost of imported goods.</p>
<ol start="9" type="1">
<li><span class="math inline">\(aord_t\)</span>: All Ordinaries Index (AORD) from yahoo finance.</li>
</ol>
<p>It reflects investor confidence and economic activity which can be pre-emptive indicators of inflation.</p>
<ol start="10" type="1">
<li><span class="math inline">\(exr_t\)</span>: AUD/USD exchange rate from RBA.</li>
</ol>
<p>It affects the price of imports and exports, contributing to inflation.</p></li>
</ul>
<p>Following Figure 1 shows the correlation between CPI and other variables.</p>
<p>Despite the low direct correlation between inflation expectations and CPI, inflation expectations may more closely reflect concerns about core inflation, which excludes volatile items like food and energy, whereas the CPI includes all items. If the trends between core inflation and overall inflation differ, this discrepancy can reduce the correlation between inflation expectations and the CPI. However, inflation expectations provide additional insight into how future economic conditions are perceived by consumers, businesses, and investors. This forward-looking perspective is important as it might influence economic decisions that are not immediately apparent through current CPI data.</p>
<p>Exchange rate fluctuations are typically sensitive to immediate market sentiment and short-term capital flows, whereas the CPI, as a measure of past price level changes, often exhibits a lag in responding to market changes. Even if the correlation between the CPI and the AUD/USD exchange rate is low, including this variable can help researchers understand economic changes from a broader perspective. For example, changes in the exchange rate can indirectly affect domestic price levels through the cost of imports, especially in open economies.</p>
<p>It should be noted that the unemployment rate exhibits a weak correlation with the CPI. This could be attributed to the Phillips Curve, which illustrates a short-term inverse relationship between unemployment and inflation. Over the long term, however, this correlation may diminish due to various influencing factors. For instance, following COVID, the inflation rate in the United States has been continuously rising due to the bankruptcy crisis among small and medium-sized enterprises (SMEs), part of which is attributed to the inadequate supply of export goods produced by SMEs leading to a decline in export volumes, thereby driving up the domestic inflation rate in the US <span class="citation" data-cites="kalemli-ozcan2020">(<a href="#ref-kalemli-ozcan2020" role="doc-biblioref">Kalemli-Ozcan et al. 2020</a>)</span>. This impact can be seen as an indirect effect of rising unemployment rates on inflation. Therefore, despite the weak correlation between unemployment rate and CPI, it is still important to include it in the model for a comprehensive analysis.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Corr Plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 1 Correlation matrix</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In summary, the dataset included data from 1990Q2 to 2024Q1, total 137 observation points with 10 variables.</p>
</section>
<section id="data-transformation" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="data-transformation"><span class="header-section-number">2.2</span> Data Transformation</h3>
<ul>
<li><strong>Quarterly Transformation</strong></li>
</ul>
<p>All data have been quarterly converted by selecting the data on the last day of the quarter as the observation. One of the reasons for not using monthly data is that high-quality quarterly economic data are more readily available compared to monthly data. In this report, the key data, CPI, which published on ABS, and the monthly data starting point is Q3 of 2017. Since the research wanted to capture longer-term data, quarterly data was considered. Also, policymakers and economists often rely more on quarterly data for decision-making because it provides a more stable and comprehensive view of economic conditions to some extent. This stability is key to understanding and predicting economic trends, especially when considering the long-term impacts of policies.</p>
<ul>
<li><strong>Log Transformation</strong></li>
</ul>
<p>Based on the line graph of the original data below (Figure 2), we can observe that exponentially growing variables need to be linearized, such as <span class="math inline">\(cpi_t\)</span>, <span class="math inline">\(gdp_t\)</span>, <span class="math inline">\(m_t\)</span>, <span class="math inline">\(export_t\)</span>, <span class="math inline">\(import_t\)</span>, <span class="math inline">\(aord_t\)</span>. Therefore, its logarithmically transformed form will be used in the following analysis.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Data plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Figure 2 Line plot of original data</p>
<ul>
<li><strong>Integration transformation</strong></li>
</ul>
<p>According to ACF plot for all data (Figure 3), we can see all data with autocorrelation. It suggests that the series is not white noise and might not be stationary.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ACF plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 3 ACF plot for all data</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Considering the selection of the order of single-order integration, the unit root test (ADF test) is used and the p value is used to determine its significance. A small p-value means the null hypothesis is rejected (non-stationary).</p>
<p>According to Table 1, we can see that <span class="math inline">\(infexp_t\)</span>, <span class="math inline">\(lm_t\)</span>, require more than first order integration, while other require first-order integration(under 5% level of confidence).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 1 Unit root test for all data </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">p value of ADF test of AR</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">p value of ADF test of diff-AR</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">conclusion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">lcpi</td>
<td style="text-align: center;">0.9875</td>
<td style="text-align: center;">0.1048</td>
<td style="text-align: center;">lcpi~I(n)</td>
</tr>
<tr class="even">
<td style="text-align: center;">infexp</td>
<td style="text-align: center;">0.0124</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">infexp~I(0)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lgdp</td>
<td style="text-align: center;">0.0188</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">lgdp~I(1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">crt</td>
<td style="text-align: center;">0.5879</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">crt~I(1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">unemp</td>
<td style="text-align: center;">0.3192</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">unemp~I(1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">lm</td>
<td style="text-align: center;">0.9045</td>
<td style="text-align: center;">0.2166</td>
<td style="text-align: center;">lm~I(n)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lexport</td>
<td style="text-align: center;">0.5086</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">lexport~I(1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">limport</td>
<td style="text-align: center;">0.8118</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">limport~I(1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">laord</td>
<td style="text-align: center;">0.5774</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">laord~I(1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">exr</td>
<td style="text-align: center;">0.3046</td>
<td style="text-align: center;">0.0100</td>
<td style="text-align: center;">exr~I(1)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Consider that differencing might eliminate some of the long-term information (like trends) within the data, and considering the Minnesota prior method can be effective with nonstationary data, we have opted apply not differencing to any of the data sets.</p>
<p>After logarithmic transformation of part of the data, the line plot of the dataset is as shown below (Figure 4). The dataset still retains some trend characteristics. For example, almost all variables showed significant changes before and after COVID (the x-aisx is 120).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Data Plot 2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 4 Line plot of adjusted data</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="importance-of-key-variables-analysis" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="importance-of-key-variables-analysis"><span class="header-section-number">2.3</span> Importance of Key Variables Analysis</h3>
<p>The model selects ten variables related to Australian inflation. Among the variables most directly related to inflation is inflation and inflation target. Meanwhile, because we use CPI as key variable, we first need to calculate quarterly inflation through CPI. Below we focus on analyzing these two variables:</p>
<ul>
<li><p>The actual and expected inflation rates appear to move in tandem over much of the time period, suggesting that expectations may be influenced by current and past inflation rates, or vice versa. At the same time, we see that people’s expectations for inflation are relatively conservative. For example, during the COVID, the expected inflation was around 5%, but the actual inflation later surged to about 7.8%.</p></li>
<li><p>Regarding the specific inflation zone of 2-3%, it appears that both the expected and actual inflation rates oscillate into this range periodically. However, it seems that starting just before 2020, there’s a pronounced peak where expected inflation sharply rises above the actual inflation rate, which then converges back into the 2-3% range shortly after (although actual inflation rate still need some time). So we can foresee that inflation will indeed fall back to the 2-3% range in the near future.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Plot inf infexp-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 5 Key data plot: Inflation rate vs Expected inflation rate</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-and-hypothesis" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="model-and-hypothesis"><span class="header-section-number">3</span> Model and Hypothesis</h2>
<p>Regarding model selection, the VAR model, capable of concurrently integrating the effects of multiple economic indicators on inflation such as GDP, exchange rates, interest rates, unemployment rates, and other variables, offers coherent and reliable results by analyzing the time series of these variables for data analysis and forecasting <span class="citation" data-cites="stock2001">(<a href="#ref-stock2001" role="doc-biblioref">Stock and Watson 2001</a>)</span>.</p>
<p>Based on the above analysis, all 10 variables play an important role in the fitting of the model. Use VAR(p) model for modeling, where N=10, T=137.</p>
<p><span id="eq-2"><span class="math display">\[
\begin{align}
y_t &amp;= \mu_0 + A_1y_{t-1} +...+A_py_{t-p} +\epsilon_t
\\
\epsilon_t|Y_{t-1} &amp;\sim iid \mathcal{N}_{10}(\textbf{0}_{10}, \Sigma)
\end{align}
\tag{2}\]</span></span></p>
<p>In matrix notation:</p>
<p><span id="eq-3"><span class="math display">\[
\begin{align}
Y &amp;= X A +E
\\
E|X &amp;\sim \mathcal{MN}_{T\times 10}(\textbf{0},\Sigma,I_T)
\end{align}
\tag{3}\]</span></span></p>
<ul>
<li><p><span class="math inline">\(Y\)</span> is <span class="math inline">\(T\times 10\)</span>matrix of dependent variables.</p></li>
<li><p><span class="math inline">\(X\)</span> is <span class="math inline">\(T \times (1 + 10p)\)</span> matrix of independent variables.</p></li>
<li><p><span class="math inline">\(A\)</span> is the matrix of coefficients, which includes the constant term <span class="math inline">\(\mu_0\)</span> and the autoregressive coefficients.</p></li>
</ul>
<p><span class="math display">\[
Y=
\begin{bmatrix}
y_{lcpi,1} &amp; y_{infexp,1} &amp; y_{lgdp,1} &amp; y_{crt,1} &amp; y_{unemp,1} &amp; y_{lm,1} &amp; y_{lexport,1} &amp; y_{limport,1} &amp; y_{laord,1} &amp; y_{exr,1}\\
\ y_{lcpi,2} &amp; y_{infexp,2} &amp; y_{lgdp,2} &amp; y_{crt,2} &amp; y_{unemp,2} &amp; y_{lm,2} &amp; y_{lexport,2} &amp; y_{limport,2} &amp; y_{laord,2} &amp; y_{exr,2} \\
\vdots  &amp; \vdots  &amp; \vdots&amp; \vdots&amp; \vdots&amp; \vdots&amp; \vdots&amp; \vdots&amp; \vdots &amp; \vdots  \\
y_{lcpi,T} &amp; y_{infexp,T} &amp; y_{lgdp,T} &amp; y_{crt,T} &amp; y_{unemp,T} &amp; y_{lm,T} &amp; y_{lexport,T} &amp; y_{limport,T} &amp; y_{laord,T} &amp; y_{exr,T}\\
\end{bmatrix}_{T \times 10}
\]</span></p>
<p><span class="math display">\[
X=\begin{bmatrix}
1 &amp; y_{lcpi,t-1} &amp; y_{infexp,t-1} &amp; \ldots &amp; y_{exr,t-1} &amp; \ldots &amp; y_{lcpi,t-p} &amp; y_{infexp,t-p} &amp; \ldots &amp;  y_{exr,t-p} \\
1 &amp; y_{lcpi,t-2} &amp; y_{infexp,t-2} &amp; \ldots &amp; y_{exr,t-2} &amp; \ldots &amp; y_{lcpi,t-p-1} &amp; y_{infexp,t-p-1} &amp; \ldots &amp;  y_{exr,t-p-1} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp;  \ddots &amp; \vdots \\
1 &amp; y_{lcpi,1} &amp; y_{infexp,1} &amp; \ldots &amp; y_{exr,1} &amp; \ldots &amp; y_{lcpi,1-p} &amp; y_{infexp,1-p} &amp; \ldots &amp;  y_{exr,1-p}\\
\end{bmatrix}_{T\times (1+10p)}
\]</span></p>
<p><span class="math display">\[
A = \begin{bmatrix}
\mu_{lcpi} &amp; \mu_{infexp} &amp; \ldots &amp; \mu_{lexr} \\
A_{1,lcpi}^{(1)} &amp; A_{1,infexp}^{(1)} &amp; \ldots &amp; A_{1,exr}^{(1)} \\
A_{2,lpci}^{(1)} &amp; A_{2,infexp}^{(1)} &amp; \ldots &amp; A_{2,exr}^{(1)} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
A_{10,lcpi}^{(1)} &amp; A_{10, infexp}^{(1)} &amp; \ldots &amp; A_{10,exr}^{(1)} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
A_{1,lcpi}^{(p)} &amp; A_{1,infexp}^{(p)} &amp; \ldots &amp; A_{1,exr}^{(p)} \\
A_{2,lcpi}^{(p)} &amp; A_{2,infexp}^{(p)} &amp; \ldots &amp; A_{2,exr}^{(p)} \\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
A_{10,lcpi}^{(p)} &amp; A_{10,infexp}^{(p)} &amp; \ldots &amp; A_{10,exr}^{(p)} \\
\end{bmatrix}_{(1 + 10p)\times 10}
\]</span></p>
<p><span class="math display">\[
\begin{align*}
E &amp;=
\begin{bmatrix}
\epsilon_{1,lcpi} &amp; \epsilon_{1,infexp} &amp; \ldots &amp; \epsilon_{1,exr} \\
\epsilon_{2,lcpi} &amp; \epsilon_{2,infexp} &amp; \ldots &amp; \epsilon_{2,exr} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\epsilon_{T,lcpi} &amp; \epsilon_{T,infexp} &amp; \ldots &amp; \epsilon_{T,exr}
\end{bmatrix}_{T\times 10}
\\
\end{align*}
\]</span></p>
<section id="model-application-and-objective-fulfillment" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="model-application-and-objective-fulfillment"><span class="header-section-number">3.1</span> Model Application and Objective Fulfillment</h3>
<p>Based on the model above, we will employ VAR of order p to carry out forecasts for the next two years. Given that the data is quarterly, setting the forecast horizon (h) to 8 quarters for our iterative forecasting process.</p>
<p>In the forecasting process, we will concentrate on determining the conditional mean and confidence interval of the projected CPI, denoted as <span class="math inline">\(lcpi_{T+h|T}\)</span>. Subsequently, we’ll utilize the forecasted (log) CPI values to calculate the inflation rate and assess whether it aligns with the target inflation range of 2-3%.</p>
</section>
</section>
<section id="estimation-procedure-and-algorithm" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="estimation-procedure-and-algorithm"><span class="header-section-number">4</span> Estimation Procedure and Algorithm</h2>
<section id="basic-model" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="basic-model"><span class="header-section-number">4.1</span> Basic Model</h3>
<section id="prior-distribution-and-posterior-distribution-specified" class="level4" data-number="4.1.1">
<h4 data-number="4.1.1" class="anchored" data-anchor-id="prior-distribution-and-posterior-distribution-specified"><span class="header-section-number">4.1.1</span> Prior Distribution and Posterior Distribution Specified</h4>
<p>The basic model based on the natural-conjugate prior distribution, which is specified as a matrix normal inverse Wishart distribution <span class="citation" data-cites="wozniak2016">(<a href="#ref-wozniak2016" role="doc-biblioref">Woźniak 2016</a>)</span>. Minnesota prior with some stylised facts about the macroeconomic time series, since <span class="math inline">\(lcpi_t\)</span> and <span class="math inline">\(lm_t\)</span> are unit root non-stationary and other all variables are stationary, is applied to form the specifications of the prior distribution.</p>
<p>The estimation procedures to draw from the posterior follows the steps below:</p>
<p><strong>Step 1</strong>: Prior distribution is presented below. We will specify <span class="math inline">\(\underline{A}\)</span>, <span class="math inline">\(\underline{V}\)</span>, <span class="math inline">\(\underline{S}\)</span> and <span class="math inline">\(\underline{v}\)</span>.</p>
<p><span class="math display">\[
\begin{align}
p(A,\Sigma) &amp;\propto L(A,\Sigma | Y,X) \ p(A|\Sigma) \ p(\Sigma)
\\
p(A,\Sigma|Y,X) &amp;= p(A|Y,X,\Sigma) \ p(\Sigma|Y,X)
\\
\\
A|\Sigma &amp;\sim \mathcal{MN}_{K\times N}(\underline{A}, \Sigma,\underline{V})
\\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S}, \underline{\nu})
\end{align}
\]</span></p>
<ul>
<li><span class="math inline">\(\underline{A}\)</span> is a <span class="math inline">\(K \times 10\)</span> matrix, reflect the random walk with no drift process on the first lag of diagonal, and 0 elsewhere.</li>
</ul>
<p><span class="math display">\[
\underline{A} = \left[ \underbrace{\textbf{0}_{10\times 1}}_{intercept} \quad  
\underbrace{
\begin{matrix}
1 &amp; \cdots  &amp;  0 &amp; \cdots &amp;  0 \\
\vdots  &amp; \ddots  &amp; \vdots  &amp; \ddots&amp;  \vdots \\
0 &amp; \cdots  &amp; 1 &amp; \cdots&amp;  0 \\
\vdots  &amp; \ddots  &amp; \vdots  &amp; \ddots&amp;  \vdots \\
0 &amp; \cdots  &amp;  0 &amp; \cdots &amp;  1\\
\end{matrix}_{10\times10} \quad
\begin{matrix}
0 &amp; \cdots  &amp;  0\\
\vdots  &amp; \ddots  &amp; \vdots  \\
0 &amp; \cdots  &amp; 0
\end{matrix}
_{10\times10(p-1))}}_{N\times(K-1)}
\right]'
\]</span></p>
<ul>
<li><span class="math inline">\(\underline{V}\)</span> represents the shrinking level of the specified <span class="math inline">\(\underline{A}\)</span>. It’s a <span class="math inline">\(K\)</span> vector diagonal matrix with the diagonal elements set to be the desired shrinking level.</li>
</ul>
<p><span class="math display">\[
\underline{V} = diag\left[ \underbrace{\kappa_{2}}_{intercept} \quad \underbrace{\kappa_{1}(\textbf{p} ^{-2}\otimes I^{'}_{N})}_{A_{1} \ to \ A_{p}}  \right]
\]</span></p>
<ul>
<li><p><span class="math inline">\(\underline{S}\)</span> is <span class="math inline">\(10\times10\)</span> symmetric matrix where the diagonal represents the variances of individual variables (diagonal of <span class="math inline">\(\Sigma\)</span>) and the off-diagonals are 0.</p></li>
<li><p><span class="math inline">\(\underline{v}\)</span> is <span class="math inline">\(N+2\)</span>, and it is a single values because variance is assumed to be the same for all elements of <span class="math inline">\(\Sigma\)</span>.</p></li>
</ul>
<p><strong>Step 2</strong>: Posterior distribution shows below with the implementation of the specification in Step 1</p>
<p><span class="math display">\[
\begin{align}
p(A,\Sigma | Y,X) &amp;= p(A|Y,X,\Sigma) \ p(\Sigma|Y,X)
\\
p(A|Y,X,\Sigma) &amp;\sim \mathcal{MN}_{K\times N}(\overline{A}, \Sigma,\overline{V} )
\\
p(\Sigma|Y,X) &amp;\sim \mathcal{IW}_{N}(\overline{S}, \overline{\nu})
\end{align}
\]</span></p>
<p>Therefore we can get:</p>
<p><span class="math display">\[
\begin{align}
\overline{A} &amp;= \overline{V}(X'Y+\underline{V}^{-1}\underline{A})
\\
\overline{V} &amp;= (X'X + \underline{V}^{-1})^{-1}
\\
\overline{S} &amp;= \underline{S}+Y'Y+\underline{A'} \ \underline{V}^{-1}\underline{A}-\overline{A'}\overline{V}^{-1}\overline{A}
\\
\overline{\nu} &amp;= T + \underline{\nu}
\end{align}
\]</span></p>
<p><strong>Step 3</strong>: As <span class="math inline">\(\overline{A}\)</span>, <span class="math inline">\(\overline{V}\)</span>, <span class="math inline">\(\overline{S}\)</span> and <span class="math inline">\(\overline{v}\)</span> are specified:</p>
<p>To obtain a sample of <span class="math inline">\(S\)</span> draws from the posterior distribution:</p>
<ol type="1">
<li><p>Sample <span class="math inline">\(S\)</span> draws from the marginal posterior distribution for <span class="math inline">\(\Sigma^{(s)}\)</span> given by <span class="math inline">\(\mathcal{IW}_{10}(\overline{S}, \overline{v})\)</span>, and collect the draws in <span class="math inline">\(\{\Sigma^{(s)}\}_{s=1}^{S}\)</span></p></li>
<li><p>For each draw <span class="math inline">\(\Sigma^{(s)}\)</span> for <span class="math inline">\(s=1,\dots,S\)</span> sample the corresponding draw of <span class="math inline">\(A^{(s)}\)</span> from <span class="math inline">\(\mathcal{MN}_{K\times 10}(\overline{A}, \Sigma^{(s)},\overline{V} )\)</span></p></li>
</ol>
<p>Output is the sample draws from the joint posterior distribution <span class="math inline">\(\left\{ {A^{(s)}, \Sigma^{(s)}} \right\}^{S}_{s=1}\)</span>.</p>
<p>Function below is <code>posterior.draws</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Posterior sample draw function for basic model(posterior.draws)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>posterior.draws       <span class="ot">=</span> <span class="cf">function</span> (S, Y, X){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Pre-setup </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    N                 <span class="ot">=</span> <span class="fu">ncol</span>(Y) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    t                 <span class="ot">=</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    p                 <span class="ot">=</span> <span class="fu">frequency</span>(Y)                        </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    A.hat             <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Y</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    Sigma.hat         <span class="ot">=</span> <span class="fu">t</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">%*%</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">/</span><span class="fu">nrow</span>(Y)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prior distribution (with Minnesota prior)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    A.prior           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(A.hat),<span class="fu">ncol</span>(A.hat))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    A.prior[<span class="dv">2</span><span class="sc">:</span>t,]     <span class="ot">=</span> <span class="fu">diag</span>(N)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    V.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    S.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(Sigma.hat))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    nu.prior          <span class="ot">=</span> N<span class="sc">+</span><span class="dv">2</span>  </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define posterior</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),N,S))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(N,N,S))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ------------------------posterior.draws----------------------------------</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Normal-inverse Wishard posterior parameters</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    V.bar.inv         <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    V.bar             <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    A.bar             <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    nu.bar            <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    S.bar             <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    S.bar.inv         <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Posterior draws </span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior,<span class="dv">3</span>,solve)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior,<span class="fu">c</span>(N,N,S))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    L                 <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      A.posterior[,,s]<span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span><span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    output            <span class="ot">=</span> <span class="fu">list</span>(<span class="at">A.posterior=</span>A.posterior, <span class="at">Sigma.posterior=</span>Sigma.posterior)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-proofing" class="level4" data-number="4.1.2">
<h4 data-number="4.1.2" class="anchored" data-anchor-id="function-proofing"><span class="header-section-number">4.1.2</span> Function Proofing</h4>
<p>Consider Bi-variate Gaussian random walk process:</p>
<p><span class="math display">\[
y_t =
\begin{bmatrix}
y_{t,1} \\
y_{t,2}
\end{bmatrix} =
\begin{bmatrix}
y_{t-1,1} \\
y_{t-1,2}
\end{bmatrix} +
\begin{bmatrix}
\epsilon_{t,1} \\
\epsilon_{t,2}
\end{bmatrix}
, where   \  \
\epsilon_{t,1} \sim \mathcal{N}(0,1)  \ and \
\epsilon_{t,2} \sim \mathcal{N}(0,1)
\]</span></p>
<p><span class="math display">\[
Y = \begin{bmatrix}
y_2' \\
y_3' \\
\vdots \\
y_n'
\end{bmatrix},
\quad
X = \begin{bmatrix}
1 \quad y_1' \\
1 \quad y_2' \\
\vdots \quad \vdots \\
1 \quad y_{n-1}'
\end{bmatrix}
\]</span></p>
<p>After estimating a model that includes a constant term and one lag using artificial data, we observe that the posterior mean of the autoregressive and covariance matrices closely approximates an identity matrix, and the posterior mean of the constant term is nearly a vector of zeros.</p>
<ul>
<li>The posterior mean of the <span class="math inline">\(A\)</span> is:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 2 Basic Model proofing simulation for A </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">A</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y1</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Constant term</td>
<td style="text-align: center;">0.0308</td>
<td style="text-align: center;">0.0718</td>
</tr>
<tr class="even">
<td style="text-align: center;">Y1 lag</td>
<td style="text-align: center;">0.9970</td>
<td style="text-align: center;">-0.0016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Y2 lag</td>
<td style="text-align: center;">-0.0019</td>
<td style="text-align: center;">0.9857</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li>The posterior mean of the <span class="math inline">\(\Sigma\)</span> is:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 3 Basic Model proofing simulation for Sigma </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Sigma</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y1</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Y1 lag</td>
<td style="text-align: center;">0.9904</td>
<td style="text-align: center;">-0.0208</td>
</tr>
<tr class="even">
<td style="text-align: center;">Y2 lag</td>
<td style="text-align: center;">-0.0208</td>
<td style="text-align: center;">0.9818</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
</section>
<section id="extended-model" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="extended-model"><span class="header-section-number">4.2</span> Extended Model</h3>
<p>The model extension base on a hierarchical model. The gamma distribution on the Minnesota shrinkage parameter lambda <span class="math inline">\(\lambda\)</span> is introduced to adjust <span class="math inline">\(V\)</span>.</p>
<section id="prior-distribution-and-posterier-distribution-specified" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="prior-distribution-and-posterier-distribution-specified"><span class="header-section-number">4.2.1</span> Prior Distribution and Posterier Distribution Specified</h4>
<p><strong>Step 1</strong>: Prior distribution is presented below. We will specify <span class="math inline">\(\underline{A}\)</span>, <span class="math inline">\(\underline{V}\)</span>, <span class="math inline">\(\underline{S}\)</span>, <span class="math inline">\(\underline{\nu}\)</span> by Minnesota shrinkage parameter lambda <span class="math inline">\(\lambda\)</span>.</p>
<p><span class="math display">\[
\begin{align}
p(A,\Sigma, \lambda |Y,X) &amp;\propto L(A,\Sigma | Y,X) \ p(A,\Sigma, \lambda) \\
&amp;\propto L(A,\Sigma | Y,X)  \ p(A |\Sigma, \lambda) \ p(\Sigma) \ p(\lambda)
\end{align}
\]</span></p>
<p>where, each <span class="math inline">\(p(A |\Sigma, k)\)</span>, <span class="math inline">\(p(\Sigma)\)</span>, <span class="math inline">\(p(k)\)</span> is specified below:</p>
<p><span class="math display">\[
\begin{align}
A |\Sigma, \lambda &amp;\sim \mathcal{MN}_{K\times N}(\underline{A}, \Sigma, \lambda\underline{V}) \\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S},\underline{\nu}) \\
\lambda &amp;\sim \mathcal{Gamma}(\underline{k_{\lambda}}, \underline{\theta_{\lambda}} ) \\
\end{align}
\]</span></p>
<p>The prior distribution is shown in the same way as the Step 1 of basic model.</p>
<p><strong>Step 2</strong>: Posterior distribution shows below with the implementation of the specification in Step 1 by multiply <span class="math inline">\(L(A,\Sigma | Y,X) \ p(A |\Sigma, \lambda) \ p(\Sigma) \ p(\lambda)\)</span></p>
<p>The probability density function of Gamma distribution is:</p>
<p><span class="math display">\[
f(x;k,\theta) = \frac{x^{k-1}e^{-\frac{x}{\theta}}}{\theta^k \ \Gamma(k)} \quad  \quad   for  \ x&gt;0, and \  k,\theta &gt;0
\]</span></p>
<p>The kernel of Gamma distribution is:</p>
<p><span class="math display">\[
p(x|k,\theta) \propto x^{k-1}e^{-\frac{x}{\theta}}
\]</span></p>
<p>Therefore all kernel shows as follow:</p>
<p><span class="math display">\[
\begin{align}
L(A,\Sigma | Y,X) &amp;= \mathrm{det} (\Sigma)^{-\frac{T}{2}}\times \mathrm{exp} \left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1}(A-\widehat{A})'X'X (A-\widehat{A})\right]\right\} \times \mathrm{exp}\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1}(Y-X\widehat{A})'(Y-X\widehat{A})\right]\right\} \\
p(A |\Sigma, \lambda) &amp;= \mathrm{det} (\Sigma)^{-\frac{K}{2}} \mathrm{det} (\lambda \underline{V} )^{-\frac{N}{2}} \mathrm{exp} \left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1} (A-\underline{A})' (\lambda\underline{V})^{-1} (A-\underline{A})\right]\right\} \\
p(\Sigma) &amp;= \mathrm{det} (\Sigma)^{\frac{\underline{\nu}+N+1}{2}} \mathrm{exp}\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1} \underline{S}\right]\right\}  \\
p(\lambda) &amp;= \lambda ^{\underline{k_{\lambda}}-1}e^{-\frac{\lambda}{\underline{\theta_{\lambda}}}}
\end{align}
\]</span></p>
<ul>
<li>The kernel of the fully conditional posterior distribution of <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span>:</li>
</ul>
<p><span class="math display">\[
\begin{align}
p(A,\Sigma |Y,X, \lambda) &amp;\propto L(Y,X|A,\Sigma)p(A |\Sigma, \lambda)p(\Sigma) \\
&amp;\propto \det(\Sigma)^{-\frac{T+N+K+\underline{\nu}+1}{2}} \\
&amp;\times \exp\left\{ -\frac{1}{2} \mathrm{tr}[\Sigma^{-1}[(A-\overline{A})'\overline{V}^{-1}(A-\overline{A})+\underline{S}+Y'Y+\underline{A}'(\lambda\underline{V})^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A}]  ] \right\} \\
\end{align}
\]</span></p>
<p>Now, we can get:</p>
<p><span class="math display">\[
\begin{align}
\overline{A} &amp;= \overline{V}(X'Y+(\lambda\underline{V})^{-1}\underline{A}) \\
\overline{V} &amp;= (X'X + (\lambda\underline{V})^{-1})^{-1}\\
\overline{S} &amp;= \underline{S}+Y'Y+\underline{A}'(\lambda\underline{V})^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A} \\
\overline{\nu} &amp;= T+\underline{\nu}
\end{align}
\]</span></p>
<ul>
<li>The kernel of the fully conditional posterior distribution of <span class="math inline">\(\lambda\)</span>:</li>
</ul>
<p><span class="math display">\[
\begin{align}
p(\lambda |Y,X,A,\Sigma ) &amp;\propto L(Y,X|A,\Sigma)p(A,\Sigma, \lambda)\\
&amp;\propto L(Y,X|A,\Sigma)p(A |\Sigma, \lambda)p(\Sigma)p(\lambda) \\
&amp;\propto p(A |\Sigma, \lambda)p(\lambda)
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
p(\lambda |Y,X,A,\Sigma )
&amp;\propto p(A |\Sigma, \lambda)p(\lambda) \\
&amp;\propto
det(\lambda \underline{V} )^{-\frac{N}{2}}exp\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1} (A-\underline{A})' (\lambda\underline{V})^{-1} (A-\underline{A})\right]\right\}  \times \lambda ^{\underline{k_{\lambda}}-1}e^{-\frac{\lambda}{\underline{\theta_{\lambda}}}} \\
&amp;\propto
det(\underline{V} )^{-\frac{N}{2}} \lambda^{-\frac{KN}{2}} exp\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1} (A-\underline{A})' (\lambda\underline{V})^{-1} (A-\underline{A})\right]\right\}  \times \lambda ^{\underline{k_{\lambda}}-1}exp \left\{ -\frac{\lambda}{\underline{\theta_{\lambda}}} \right\} \\
&amp;\propto
\lambda^{-\frac{KN}{2} + \underline{k_{\lambda}}-1 } exp\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1} (A-\underline{A})' (\lambda\underline{V})^{-1} (A-\underline{A})\right]-\frac{\lambda}{\underline{\theta_{\lambda}}} \right\} \\
&amp;\propto
\lambda^{-\frac{KN}{2} + \underline{k_{\lambda}}-1 } exp\left\{ -\frac{\mathrm{tr}\left[ \Sigma^{-1} (A-\underline{A})' (\underline{V})^{-1} (A-\underline{A})\right]}{2\lambda}
-\frac{\lambda}{\underline{\theta_{\lambda}}} \right\}\\
&amp;\propto
\lambda^{-\frac{KN}{2} + \underline{k_{\lambda}}-1 }
exp\left\{ \frac{- \left[ \frac{1}{\lambda} \mathrm{tr}  \left[ \Sigma^{-1} (A-\underline{A})' (\underline{V})^{-1} (A-\underline{A})\right]  + \frac{\lambda}{ \frac{1}{2} \underline{\theta_{\lambda}}}\right]}{2}
\right\}\\
\end{align}
\]</span></p>
<p>As we can figure out the kernel follows generalized inverse Gaussian distribution (GIG):</p>
<p><span class="math display">\[
f(x;a,b,p)=\frac{(a/b)^{p/2}}{2K_p(\sqrt{ab})}x^{(p-1)}e^{-(ax+b/x)/2}, \quad \quad    x&gt;0
\]</span></p>
<p>The kernel of GIG:</p>
<p><span class="math display">\[
p(x|a,b,p) \propto x^{p-1} \mathrm{exp} \left\{\frac{-(ax+\frac{b}{x})}{2} \right\}
\]</span></p>
<p>Hence, the full-conditional posterior distribution of <span class="math inline">\(\lambda\)</span> follows a Generalised Inverse Gaussian distribution.</p>
<p><span class="math display">\[
\lambda|Y,X,A,\Sigma \sim \mathcal{GIG}(\overline{a},\overline{b},\overline{p})
\]</span></p>
<p>Therefore we can get:</p>
<p><span class="math display">\[
\begin{align}
\overline{a} &amp;= \frac{2}{\underline{\theta_{\lambda}} }
\\
\overline{b} &amp;= \mathrm{tr}  \left[ \Sigma^{-1} (A-\underline{A})' (\underline{V})^{-1} (A-\underline{A})\right]
\\
\overline{p} &amp;= -\frac{KN}{2} + \underline{k_{\lambda}}
\end{align}
\]</span></p>
<p><strong>Step 3</strong>: As <span class="math inline">\(\overline{A}\)</span>, <span class="math inline">\(\overline{V}\)</span>, <span class="math inline">\(\overline{S}\)</span>, <span class="math inline">\(\overline{v}\)</span>, <span class="math inline">\(\overline{a}\)</span>, <span class="math inline">\(\overline{b}\)</span>, <span class="math inline">\(\overline{p}\)</span> are specified:</p>
<p>Initialize <span class="math inline">\(\lambda\)</span> at <span class="math inline">\(\lambda^{(0)}\)</span>.</p>
<p>At each iteration <span class="math inline">\(s\)</span>:</p>
<ol type="1">
<li><p>Draw random matrices for <span class="math inline">\(A^{(s)}\)</span> and <span class="math inline">\(\Sigma^{(s)}\)</span> from <span class="math inline">\(p(A,\Sigma|Y,X,\lambda^{(s-1)})\)</span>.</p></li>
<li><p>Draw a random number for <span class="math inline">\(\lambda^{(s)}\)</span> from <span class="math inline">\(p(\lambda |Y,X,A^{(s)},\Sigma^{(s)})\)</span>.</p></li>
</ol>
<p>Repeat 1 and 2 <span class="math inline">\(S_{1} + S_{2}\)</span> times.</p>
<p>Discard the first <span class="math inline">\(S_{1}\)</span> draws that allows the algorithm to converge to the stationary posterior distribution.</p>
<p>Output is the sample draws from the joint posterior distribution <span class="math inline">\(\left\{ {A^{(s)}, \Sigma^{(s)}, \lambda^{(s)}} \right\}^{S_{1}+S_{2}}_{s=S_{1}+1}\)</span>.</p>
<p>Function below is <code>posterior.draws.exten</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Posterior sample draw function for extended model(posterior.draws.exten)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>posterior.draws.exten <span class="ot">=</span> <span class="cf">function</span> (total_S, Y, X){</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Pre-setup </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">=</span> <span class="fu">ncol</span>(Y) </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  t             <span class="ot">=</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  p             <span class="ot">=</span> <span class="fu">frequency</span>(Y)                        </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  A.hat         <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Y</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  Sigma.hat     <span class="ot">=</span> <span class="fu">t</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">%*%</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">/</span><span class="fu">nrow</span>(Y)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  K             <span class="ot">=</span> <span class="fu">ncol</span>(X)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prior distribution (with Minnesota prior)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  A.prior           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(A.hat),<span class="fu">ncol</span>(A.hat))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  A.prior[<span class="dv">2</span><span class="sc">:</span>t,]     <span class="ot">=</span> <span class="fu">diag</span>(N)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  V.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  S.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(Sigma.hat))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  nu.prior          <span class="ot">=</span> N<span class="sc">+</span><span class="dv">2</span>  </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define posterior</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),N,S1<span class="sc">+</span>S2))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(N,N,S1<span class="sc">+</span>S2))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  lambda.posterior  <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S1<span class="sc">+</span>S2, <span class="dv">1</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial value of lambda</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  lambda.posterior[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">10</span>                            <span class="co"># set lambda0 </span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------posterior.draws.exten------------------------------</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_S){</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># NIW posterior parameters</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      V.bar.inv              <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(lambda.posterior[s]<span class="sc">*</span> V.prior)) </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      V.bar                  <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      A.bar                  <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(lambda.posterior[s]<span class="sc">*</span> V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      nu.bar                 <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      S.bar                  <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(lambda.posterior[s]<span class="sc">*</span> V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>      S.bar.inv              <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>      <span class="co"># posterior draws for A and Sigma</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior.IW     <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior.draw   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior.IW,<span class="dv">3</span>,solve)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior[,,s]   <span class="ot">=</span> Sigma.posterior.draw</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>      A.posterior[,,s]       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),<span class="dv">1</span>))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),<span class="dv">1</span>))</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>      L                      <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>      A.posterior[,,s]       <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span><span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Update parameters for lambda posterior</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>      p                      <span class="ot">=</span> lambda.priors<span class="sc">$</span>k <span class="sc">-</span> (K <span class="sc">*</span> N)<span class="sc">/</span><span class="dv">2</span>              <span class="co"># N=10</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>      diff_A                 <span class="ot">=</span> A.posterior[,,s] <span class="sc">-</span> A.prior</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>      product                <span class="ot">=</span> <span class="fu">t</span>(diff_A) <span class="sc">%*%</span> <span class="fu">solve</span>(V.prior) <span class="sc">%*%</span> diff_A</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>      b                      <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(Sigma.posterior[,,s] <span class="sc">%*%</span> product)))</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>      a                      <span class="ot">=</span> <span class="dv">2</span> <span class="sc">/</span> lambda.priors<span class="sc">$</span>theta</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Draw next period value for lambda from GIG distribution</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (s<span class="sc">!=</span>total_S){</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        lambda.posterior[s<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">lambda =</span> p, <span class="at">chi =</span> b, <span class="at">psi =</span> a)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>      output                 <span class="ot">=</span> <span class="fu">list</span>(<span class="at">A.posterior.exten =</span> A.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S2], </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Sigma.posterior.exten =</span> Sigma.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S2], </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">lambda.posterior.exten =</span> lambda.posterior[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S2,])</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(output)</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-proofing-1" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="function-proofing-1"><span class="header-section-number">4.2.2</span> Function Proofing</h4>
<p>After fitting a model that includes a constant term and one lag with artificial data, just like the basic model, the extend model also shows that the posterior mean of both the autoregressive and covariance matrices closely identity matrix, and the posterior mean of the constant term is almost a vector of zeros.</p>
<ul>
<li>The posterior mean of the <span class="math inline">\(A\)</span> is:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 4 Extend Model proofing simulation for A </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">A</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y1</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Constant term</td>
<td style="text-align: center;">0.0304</td>
<td style="text-align: center;">0.0705</td>
</tr>
<tr class="even">
<td style="text-align: center;">Y1 lag</td>
<td style="text-align: center;">0.9969</td>
<td style="text-align: center;">-0.0016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Y2 lag</td>
<td style="text-align: center;">-0.0019</td>
<td style="text-align: center;">0.9858</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li>The posterior mean of the <span class="math inline">\(\Sigma\)</span> is:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 5 Extend Model proofing simulation for Sigma </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Sigma</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y1</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Simulation Parameter Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Y1 lag</td>
<td style="text-align: center;">0.9903</td>
<td style="text-align: center;">-0.0209</td>
</tr>
<tr class="even">
<td style="text-align: center;">Y2 lag</td>
<td style="text-align: center;">-0.0209</td>
<td style="text-align: center;">0.9828</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
</section>
</section>
<section id="empirical-analysis---model-applying-and-forecasing" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="empirical-analysis---model-applying-and-forecasing"><span class="header-section-number">5</span> Empirical Analysis - Model Applying and Forecasing</h2>
<section id="basic-model-1" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="basic-model-1"><span class="header-section-number">5.1</span> Basic Model</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 6 Mean Values of A.posterior.simu (head 11) </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.022487</td>
<td style="text-align: center;">0.239344</td>
<td style="text-align: center;">0.015375</td>
<td style="text-align: center;">3.772253</td>
<td style="text-align: center;">0.762991</td>
<td style="text-align: center;">-0.026571</td>
<td style="text-align: center;">0.041992</td>
<td style="text-align: center;">0.209237</td>
<td style="text-align: center;">0.354570</td>
<td style="text-align: center;">0.153967</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.997695</td>
<td style="text-align: center;">-0.113153</td>
<td style="text-align: center;">-0.002101</td>
<td style="text-align: center;">0.041971</td>
<td style="text-align: center;">0.081012</td>
<td style="text-align: center;">-0.001401</td>
<td style="text-align: center;">0.010894</td>
<td style="text-align: center;">0.018803</td>
<td style="text-align: center;">0.020152</td>
<td style="text-align: center;">0.001117</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.004636</td>
<td style="text-align: center;">0.488874</td>
<td style="text-align: center;">-0.000002</td>
<td style="text-align: center;">0.172252</td>
<td style="text-align: center;">-0.044286</td>
<td style="text-align: center;">0.001115</td>
<td style="text-align: center;">0.011634</td>
<td style="text-align: center;">0.018032</td>
<td style="text-align: center;">-0.012363</td>
<td style="text-align: center;">-0.017317</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000967</td>
<td style="text-align: center;">-0.084569</td>
<td style="text-align: center;">0.998710</td>
<td style="text-align: center;">0.246898</td>
<td style="text-align: center;">0.013631</td>
<td style="text-align: center;">-0.002384</td>
<td style="text-align: center;">-0.001717</td>
<td style="text-align: center;">0.003282</td>
<td style="text-align: center;">0.037560</td>
<td style="text-align: center;">0.009190</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.001482</td>
<td style="text-align: center;">0.172613</td>
<td style="text-align: center;">-0.000503</td>
<td style="text-align: center;">1.039676</td>
<td style="text-align: center;">-0.180908</td>
<td style="text-align: center;">-0.000909</td>
<td style="text-align: center;">0.022218</td>
<td style="text-align: center;">0.003863</td>
<td style="text-align: center;">0.004724</td>
<td style="text-align: center;">0.002909</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.001882</td>
<td style="text-align: center;">-0.167358</td>
<td style="text-align: center;">0.005032</td>
<td style="text-align: center;">-0.143112</td>
<td style="text-align: center;">0.889873</td>
<td style="text-align: center;">0.001887</td>
<td style="text-align: center;">-0.002966</td>
<td style="text-align: center;">-0.013108</td>
<td style="text-align: center;">-0.006123</td>
<td style="text-align: center;">-0.009323</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.000705</td>
<td style="text-align: center;">0.013135</td>
<td style="text-align: center;">-0.004998</td>
<td style="text-align: center;">-0.149762</td>
<td style="text-align: center;">0.141990</td>
<td style="text-align: center;">0.989428</td>
<td style="text-align: center;">0.014266</td>
<td style="text-align: center;">0.072869</td>
<td style="text-align: center;">0.019394</td>
<td style="text-align: center;">-0.008221</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.001703</td>
<td style="text-align: center;">-0.098460</td>
<td style="text-align: center;">0.002827</td>
<td style="text-align: center;">-0.094150</td>
<td style="text-align: center;">-0.083816</td>
<td style="text-align: center;">-0.000519</td>
<td style="text-align: center;">0.909877</td>
<td style="text-align: center;">-0.039209</td>
<td style="text-align: center;">-0.027771</td>
<td style="text-align: center;">-0.001008</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.003402</td>
<td style="text-align: center;">0.045982</td>
<td style="text-align: center;">-0.006957</td>
<td style="text-align: center;">-0.429023</td>
<td style="text-align: center;">0.138237</td>
<td style="text-align: center;">-0.003229</td>
<td style="text-align: center;">-0.005963</td>
<td style="text-align: center;">0.878758</td>
<td style="text-align: center;">-0.004867</td>
<td style="text-align: center;">0.001058</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.003383</td>
<td style="text-align: center;">0.669583</td>
<td style="text-align: center;">0.013316</td>
<td style="text-align: center;">0.181981</td>
<td style="text-align: center;">-0.579936</td>
<td style="text-align: center;">0.012783</td>
<td style="text-align: center;">0.058214</td>
<td style="text-align: center;">0.083007</td>
<td style="text-align: center;">0.928924</td>
<td style="text-align: center;">-0.021260</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.001894</td>
<td style="text-align: center;">0.309709</td>
<td style="text-align: center;">0.006359</td>
<td style="text-align: center;">0.415477</td>
<td style="text-align: center;">-0.135637</td>
<td style="text-align: center;">0.008211</td>
<td style="text-align: center;">0.023505</td>
<td style="text-align: center;">0.059918</td>
<td style="text-align: center;">-0.028299</td>
<td style="text-align: center;">0.979138</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 7 Mean Values of Sigma.posterior.simu </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.000021</td>
<td style="text-align: center;">0.000459</td>
<td style="text-align: center;">0.000014</td>
<td style="text-align: center;">0.000182</td>
<td style="text-align: center;">-0.000390</td>
<td style="text-align: center;">-0.000004</td>
<td style="text-align: center;">0.000002</td>
<td style="text-align: center;">0.000049</td>
<td style="text-align: center;">-0.000005</td>
<td style="text-align: center;">0.000011</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000459</td>
<td style="text-align: center;">0.220484</td>
<td style="text-align: center;">0.000617</td>
<td style="text-align: center;">0.034636</td>
<td style="text-align: center;">-0.031898</td>
<td style="text-align: center;">-0.000638</td>
<td style="text-align: center;">0.005437</td>
<td style="text-align: center;">0.010908</td>
<td style="text-align: center;">-0.001779</td>
<td style="text-align: center;">-0.000168</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000014</td>
<td style="text-align: center;">0.000617</td>
<td style="text-align: center;">0.000089</td>
<td style="text-align: center;">0.000184</td>
<td style="text-align: center;">-0.001472</td>
<td style="text-align: center;">-0.000006</td>
<td style="text-align: center;">0.000083</td>
<td style="text-align: center;">0.000149</td>
<td style="text-align: center;">-0.000017</td>
<td style="text-align: center;">0.000017</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000182</td>
<td style="text-align: center;">0.034636</td>
<td style="text-align: center;">0.000184</td>
<td style="text-align: center;">0.138102</td>
<td style="text-align: center;">-0.001529</td>
<td style="text-align: center;">-0.000361</td>
<td style="text-align: center;">-0.000289</td>
<td style="text-align: center;">-0.002042</td>
<td style="text-align: center;">0.004264</td>
<td style="text-align: center;">0.004481</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.000390</td>
<td style="text-align: center;">-0.031898</td>
<td style="text-align: center;">-0.001472</td>
<td style="text-align: center;">-0.001529</td>
<td style="text-align: center;">0.073025</td>
<td style="text-align: center;">0.000112</td>
<td style="text-align: center;">-0.001582</td>
<td style="text-align: center;">-0.000612</td>
<td style="text-align: center;">0.000788</td>
<td style="text-align: center;">-0.000951</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.000004</td>
<td style="text-align: center;">-0.000638</td>
<td style="text-align: center;">-0.000006</td>
<td style="text-align: center;">-0.000361</td>
<td style="text-align: center;">0.000112</td>
<td style="text-align: center;">0.000128</td>
<td style="text-align: center;">0.000012</td>
<td style="text-align: center;">-0.000036</td>
<td style="text-align: center;">0.000016</td>
<td style="text-align: center;">0.000005</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000002</td>
<td style="text-align: center;">0.005437</td>
<td style="text-align: center;">0.000083</td>
<td style="text-align: center;">-0.000289</td>
<td style="text-align: center;">-0.001582</td>
<td style="text-align: center;">0.000012</td>
<td style="text-align: center;">0.001990</td>
<td style="text-align: center;">0.001128</td>
<td style="text-align: center;">0.000072</td>
<td style="text-align: center;">-0.000336</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000049</td>
<td style="text-align: center;">0.010908</td>
<td style="text-align: center;">0.000149</td>
<td style="text-align: center;">-0.002042</td>
<td style="text-align: center;">-0.000612</td>
<td style="text-align: center;">-0.000036</td>
<td style="text-align: center;">0.001128</td>
<td style="text-align: center;">0.004843</td>
<td style="text-align: center;">-0.000636</td>
<td style="text-align: center;">-0.001085</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.000005</td>
<td style="text-align: center;">-0.001779</td>
<td style="text-align: center;">-0.000017</td>
<td style="text-align: center;">0.004264</td>
<td style="text-align: center;">0.000788</td>
<td style="text-align: center;">0.000016</td>
<td style="text-align: center;">0.000072</td>
<td style="text-align: center;">-0.000636</td>
<td style="text-align: center;">0.004417</td>
<td style="text-align: center;">0.001134</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000011</td>
<td style="text-align: center;">-0.000168</td>
<td style="text-align: center;">0.000017</td>
<td style="text-align: center;">0.004481</td>
<td style="text-align: center;">-0.000951</td>
<td style="text-align: center;">0.000005</td>
<td style="text-align: center;">-0.000336</td>
<td style="text-align: center;">-0.001085</td>
<td style="text-align: center;">0.001134</td>
<td style="text-align: center;">0.001518</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Histograms Trace Plots Basic-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 6 Histograms and trace plots on key variables using basic model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Figure 7 presents a 3D visualization of the density intervals for the log CPI and inflation expectations. Inflation expectations show some fluctuations, while the log CPI exhibits a stable increase. as indicated by the narrow bounded confidence intervals (light blue for CPI and light green for inflation expectations). The varying heights of the intervals reflect the level of prediction certainty; as we project further into the future, the intervals become wider and more dispersed due to increased uncertainty.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/3d Forecasting Graph on Basic-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 7 3D forecasting graph on basic model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>After an in-depth examination of key variables and converting the log CPI to CPI to calculate the inflation rate for the next eight periods (Figure 8), we found contrary results. Both the inflation rate and inflation expectations show a downward trend. Although they will remain within the RBA’s target range for a while, they are expected to fall below 2% after 2025. As for people’s inflation expectations, the forecast indicates a fluctuating decline.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Basic Key Data Plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 8 Basic Model key data plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extended-model-1" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="extended-model-1"><span class="header-section-number">5.2</span> Extended Model</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 8 Mean Values of A.posterior.ext.simu (head 11) </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.188638</td>
<td style="text-align: center;">35.636598</td>
<td style="text-align: center;">1.195273</td>
<td style="text-align: center;">44.207740</td>
<td style="text-align: center;">22.216190</td>
<td style="text-align: center;">0.595854</td>
<td style="text-align: center;">2.075501</td>
<td style="text-align: center;">15.213020</td>
<td style="text-align: center;">0.602600</td>
<td style="text-align: center;">1.928389</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.900940</td>
<td style="text-align: center;">3.146955</td>
<td style="text-align: center;">-0.036595</td>
<td style="text-align: center;">2.877600</td>
<td style="text-align: center;">3.493241</td>
<td style="text-align: center;">-0.006319</td>
<td style="text-align: center;">0.341870</td>
<td style="text-align: center;">0.725178</td>
<td style="text-align: center;">0.036034</td>
<td style="text-align: center;">0.078436</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.004860</td>
<td style="text-align: center;">0.319458</td>
<td style="text-align: center;">-0.000436</td>
<td style="text-align: center;">0.148774</td>
<td style="text-align: center;">-0.041142</td>
<td style="text-align: center;">0.003409</td>
<td style="text-align: center;">0.022329</td>
<td style="text-align: center;">0.013966</td>
<td style="text-align: center;">0.004776</td>
<td style="text-align: center;">-0.014972</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.019861</td>
<td style="text-align: center;">-2.486073</td>
<td style="text-align: center;">0.845654</td>
<td style="text-align: center;">-4.548681</td>
<td style="text-align: center;">-4.229855</td>
<td style="text-align: center;">-0.013692</td>
<td style="text-align: center;">-0.008236</td>
<td style="text-align: center;">-0.795376</td>
<td style="text-align: center;">0.581042</td>
<td style="text-align: center;">-0.150850</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.001933</td>
<td style="text-align: center;">0.060133</td>
<td style="text-align: center;">-0.003035</td>
<td style="text-align: center;">0.919842</td>
<td style="text-align: center;">-0.176445</td>
<td style="text-align: center;">-0.002643</td>
<td style="text-align: center;">0.012271</td>
<td style="text-align: center;">-0.032752</td>
<td style="text-align: center;">0.019441</td>
<td style="text-align: center;">0.011998</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.002557</td>
<td style="text-align: center;">-0.214560</td>
<td style="text-align: center;">0.002556</td>
<td style="text-align: center;">-0.294931</td>
<td style="text-align: center;">0.732430</td>
<td style="text-align: center;">0.004052</td>
<td style="text-align: center;">-0.020502</td>
<td style="text-align: center;">-0.035284</td>
<td style="text-align: center;">-0.027651</td>
<td style="text-align: center;">-0.024297</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.022130</td>
<td style="text-align: center;">-0.515608</td>
<td style="text-align: center;">-0.006018</td>
<td style="text-align: center;">0.961101</td>
<td style="text-align: center;">0.222468</td>
<td style="text-align: center;">0.949607</td>
<td style="text-align: center;">-0.172691</td>
<td style="text-align: center;">-0.297743</td>
<td style="text-align: center;">0.880789</td>
<td style="text-align: center;">0.457458</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.035743</td>
<td style="text-align: center;">2.764934</td>
<td style="text-align: center;">0.055280</td>
<td style="text-align: center;">0.652448</td>
<td style="text-align: center;">-1.266774</td>
<td style="text-align: center;">-0.030087</td>
<td style="text-align: center;">0.427812</td>
<td style="text-align: center;">0.088200</td>
<td style="text-align: center;">-0.407933</td>
<td style="text-align: center;">-0.023934</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.007550</td>
<td style="text-align: center;">-0.448692</td>
<td style="text-align: center;">-0.023527</td>
<td style="text-align: center;">-0.543887</td>
<td style="text-align: center;">0.137763</td>
<td style="text-align: center;">-0.008414</td>
<td style="text-align: center;">-0.057218</td>
<td style="text-align: center;">0.521559</td>
<td style="text-align: center;">0.071008</td>
<td style="text-align: center;">0.049988</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.010449</td>
<td style="text-align: center;">1.917557</td>
<td style="text-align: center;">0.034389</td>
<td style="text-align: center;">0.136375</td>
<td style="text-align: center;">-2.036329</td>
<td style="text-align: center;">-0.005872</td>
<td style="text-align: center;">0.097489</td>
<td style="text-align: center;">0.136197</td>
<td style="text-align: center;">0.883124</td>
<td style="text-align: center;">-0.059768</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.024233</td>
<td style="text-align: center;">1.018000</td>
<td style="text-align: center;">0.033507</td>
<td style="text-align: center;">2.871187</td>
<td style="text-align: center;">-0.668580</td>
<td style="text-align: center;">0.036330</td>
<td style="text-align: center;">-0.035254</td>
<td style="text-align: center;">0.173904</td>
<td style="text-align: center;">-0.269526</td>
<td style="text-align: center;">0.963305</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 9 Mean Values of Sigma.posterior.ext.simu </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.000014</td>
<td style="text-align: center;">0.000367</td>
<td style="text-align: center;">0.000008</td>
<td style="text-align: center;">0.000030</td>
<td style="text-align: center;">-0.000228</td>
<td style="text-align: center;">-0.000002</td>
<td style="text-align: center;">0.000023</td>
<td style="text-align: center;">0.000026</td>
<td style="text-align: center;">0.000005</td>
<td style="text-align: center;">0.000010</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000367</td>
<td style="text-align: center;">0.144469</td>
<td style="text-align: center;">0.000242</td>
<td style="text-align: center;">0.018481</td>
<td style="text-align: center;">-0.019191</td>
<td style="text-align: center;">-0.000265</td>
<td style="text-align: center;">0.004833</td>
<td style="text-align: center;">0.006759</td>
<td style="text-align: center;">0.000755</td>
<td style="text-align: center;">0.000708</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000008</td>
<td style="text-align: center;">0.000242</td>
<td style="text-align: center;">0.000068</td>
<td style="text-align: center;">-0.000001</td>
<td style="text-align: center;">-0.001145</td>
<td style="text-align: center;">-0.000008</td>
<td style="text-align: center;">0.000090</td>
<td style="text-align: center;">0.000081</td>
<td style="text-align: center;">0.000013</td>
<td style="text-align: center;">0.000014</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000030</td>
<td style="text-align: center;">0.018481</td>
<td style="text-align: center;">-0.000001</td>
<td style="text-align: center;">0.110137</td>
<td style="text-align: center;">0.001269</td>
<td style="text-align: center;">-0.000326</td>
<td style="text-align: center;">-0.000953</td>
<td style="text-align: center;">-0.004963</td>
<td style="text-align: center;">0.004482</td>
<td style="text-align: center;">0.004446</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.000228</td>
<td style="text-align: center;">-0.019191</td>
<td style="text-align: center;">-0.001145</td>
<td style="text-align: center;">0.001269</td>
<td style="text-align: center;">0.049088</td>
<td style="text-align: center;">0.000061</td>
<td style="text-align: center;">-0.001900</td>
<td style="text-align: center;">-0.000554</td>
<td style="text-align: center;">-0.000150</td>
<td style="text-align: center;">-0.001166</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.000002</td>
<td style="text-align: center;">-0.000265</td>
<td style="text-align: center;">-0.000008</td>
<td style="text-align: center;">-0.000326</td>
<td style="text-align: center;">0.000061</td>
<td style="text-align: center;">0.000092</td>
<td style="text-align: center;">-0.000021</td>
<td style="text-align: center;">-0.000026</td>
<td style="text-align: center;">0.000043</td>
<td style="text-align: center;">-0.000002</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000023</td>
<td style="text-align: center;">0.004833</td>
<td style="text-align: center;">0.000090</td>
<td style="text-align: center;">-0.000953</td>
<td style="text-align: center;">-0.001900</td>
<td style="text-align: center;">-0.000021</td>
<td style="text-align: center;">0.001380</td>
<td style="text-align: center;">0.000812</td>
<td style="text-align: center;">-0.000040</td>
<td style="text-align: center;">-0.000303</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000026</td>
<td style="text-align: center;">0.006759</td>
<td style="text-align: center;">0.000081</td>
<td style="text-align: center;">-0.004963</td>
<td style="text-align: center;">-0.000554</td>
<td style="text-align: center;">-0.000026</td>
<td style="text-align: center;">0.000812</td>
<td style="text-align: center;">0.003398</td>
<td style="text-align: center;">-0.000276</td>
<td style="text-align: center;">-0.000899</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000005</td>
<td style="text-align: center;">0.000755</td>
<td style="text-align: center;">0.000013</td>
<td style="text-align: center;">0.004482</td>
<td style="text-align: center;">-0.000150</td>
<td style="text-align: center;">0.000043</td>
<td style="text-align: center;">-0.000040</td>
<td style="text-align: center;">-0.000276</td>
<td style="text-align: center;">0.003541</td>
<td style="text-align: center;">0.000883</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000010</td>
<td style="text-align: center;">0.000708</td>
<td style="text-align: center;">0.000014</td>
<td style="text-align: center;">0.004446</td>
<td style="text-align: center;">-0.001166</td>
<td style="text-align: center;">-0.000002</td>
<td style="text-align: center;">-0.000303</td>
<td style="text-align: center;">-0.000899</td>
<td style="text-align: center;">0.000883</td>
<td style="text-align: center;">0.001342</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Histograms Trace Plots Extended-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 9 Histograms and trace plots on key variables using extended model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Figure 10 presents a 3D visualization of the density intervals for the log CPI and inflation expectations calculated by the extension model. The results are generally similar to those of the basic model, with the only difference being that the log CPI shows a downward trend instead of an upward one.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/3d Forecasting Graph on Extension-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 10 3d forecasting graph on extension model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>For the analysis of key data, we can see that the extension model presents a more aggressive outlook compared to the basic model (Figure 11). The expected inflation rate continues to decline over the next eight quarters, reaching negative values by the end of 2024 (deflation). People’s inflation expectations are also volatile, fluctuating within the 0%-2% range.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Extend Model Key Data Plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 11 Extend Model key data plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="asides---different-priors-and-assumptions" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="asides---different-priors-and-assumptions"><span class="header-section-number">5.3</span> Asides - Different Priors and Assumptions</h3>
<p>Until here, we realized that the extended model is more radical, and we decided to rethink the prior settings in the extended model and compare: In the extended model, consider the coefficient <span class="math inline">\(\lambda\)</span>(follow gamma distribution.)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Dist-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 12 Gamma distribution</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>For the Gamma distribution with parameters <span class="math inline">\((k,θ)=(1,0.1)\)</span> (red line), the density is highly concentrated near zero, making it very steep. This distribution is ideal for modeling high-frequency, short-duration events such as waiting times or time between failures. Compared to distributions with larger shape or scale parameters, this one lacks support for larger values, indicating most events occur within a very short time frame.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Test-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 13 Predictive density of lcpi with different k and theta</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The predictive density distribution remains stable despite changes in the prior distribution of the Gamma distribution in lambda, indicating that the predictive values have stabilized in the Gibbs sampler. This suggests that our forecast is robust, and resulting in a stable posterior distribution and predictive outcome. Consequently, the predictive results are primarily driven by the data rather than the prior assumptions.</p>
</section>
</section>
<section id="stochastic-volatility-conditional-heteroskedasticity" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="stochastic-volatility-conditional-heteroskedasticity"><span class="header-section-number">6</span> Stochastic Volatility Conditional Heteroskedasticity</h2>
<p>Until now, we acknowledge that our model has not achieved the most optimal results. Our modeling approach has operated under the assumption of homoscedasticity. However, in real-world, such as the 2008 financial crisis and the 2020 COVID-19 pandemic, have demonstrated the significant and often abrupt fluctuations in the economy and financial markets. These events underscore the necessity of incorporating heteroscedasticity into our model to more accurately reflect the variable nature of economic conditions and market volatility.</p>
<section id="basic-model-with-heteroskedasticity" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="basic-model-with-heteroskedasticity"><span class="header-section-number">6.1</span> Basic Model with Heteroskedasticity</h3>
<p>The model specification is as below:</p>
<p><span id="eq-4"><span class="math display">\[
\begin{align}
Y &amp;= X A +E
\\
E|X &amp;\sim \mathcal{MN}_{T\times 10}(\textbf{0},\Sigma,\mathrm{diag}(\sigma_{T}^{2}))
\end{align}
\tag{4}\]</span></span></p>
<p><strong>Step 1</strong>: Prior distribution is presented below. We will specify <span class="math inline">\(\underline{A}\)</span>, <span class="math inline">\(\underline{V}\)</span>, <span class="math inline">\(\underline{S}\)</span> and <span class="math inline">\(\underline{v}\)</span>.</p>
<p><span class="math display">\[
\begin{align}
p(A,\Sigma) &amp;\propto L(A,\Sigma | Y,X) \ p(A,\Sigma) \\
p(A,\Sigma) &amp;\propto L(A,\Sigma | Y,X) \ p(A|\Sigma) \ p(\Sigma)
\\
\\
A|\Sigma &amp;\sim \mathcal{MN}_{K\times N}(\underline{A}, \Sigma,\underline{V})
\\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S}, \underline{\nu})
\end{align}
\]</span></p>
<ul>
<li>Likelihood function</li>
</ul>
<p><span class="math display">\[
\begin{align}
L\left( {A},{\Sigma}|Y,X \right) &amp;\propto \text{det}({\Sigma})^{-\frac{T}{2}}\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}(Y-X{A})'(Y-X{A}) \right] \right\}\\
&amp;=\text{det}({\Sigma})^{-\frac{T}{2}}\\
&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}({A}-\widehat{A})'X' \ \mathrm{diag}(\sigma_{T}^{2}) \ X({A}-\widehat{A}) \right] \right\}\\
&amp;\quad\times \exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}(Y-X\widehat{A})' \ \mathrm{diag}(\sigma_{T}^{2}) \ (Y-X\widehat{A}) \right] \right\}
\end{align}
\]</span></p>
<ul>
<li>Natural-conjugate prior distribution (kernel)</li>
</ul>
<p><span class="math display">\[
\begin{align}
p\left({A},{\Sigma} \right) &amp;\propto \text{det}({\Sigma})^{-\frac{N+K+\underline{\nu}+1}{2}}\\&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}({A}-\underline{A})'\underline{V}^{-1}({A}-\underline{A}) \right] \right\}\\&amp;\quad\times \exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}\underline{S} \right] \right\}
\end{align}
\]</span></p>
<p><strong>Step 2</strong>: Posterior distribution shows below with the implementation of the specification in Step 1</p>
<p><span class="math display">\[
\begin{align}
p\left( A, \Sigma|Y,X \right)
&amp;\propto L({A},{\Sigma}|Y,X)p\left( {A}, {\Sigma} \right)\\
&amp;= L({A},{\Sigma}|Y,X)p\left( {A}| {\Sigma} \right)p\left( {\Sigma} \right)
\end{align}
\]</span></p>
<ul>
<li>kernel:</li>
</ul>
<p><span class="math display">\[
\begin{align*}
p\left( {A},{\Sigma} |Y,X\right)
&amp;\propto  \text{det}({\Sigma})^{-\frac{T}{2}}\\
&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}({A}-\widehat{A})'X' \ \mathrm{diag}(\sigma_{T}^{2}) \ X({A}-\widehat{A}) \right] \right\}\\
&amp;\quad\times \exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}(Y-X\widehat{A})' \ \mathrm{diag}(\sigma_{T}^{2}) \ (Y-X\widehat{A}) \right] \right\}\\
&amp; \quad\times\text{det}({\Sigma})^{-\frac{N+K+\underline{\nu}+1}{2}}\\
&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}({A}-\underline{A})'\underline{V}^{-1}({A}-\underline{A}) \right] \right\}\\
&amp;\quad\times \exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}\underline{S} \right] \right\} \\
&amp;\propto\text{det}({\Sigma})^{-\frac{\overbrace{T+\underline{\nu}}^{\overline{\nu}} +N+K+1}{2}} \\
&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}
\color{blue}{\left[({A}-\widehat{A})'X' \ \mathrm{diag}(\sigma_{T}^{2}) \ X({A}-\widehat{A}) + ({A}-\underline{A})'\underline{V}^{-1}({A}-\underline{A})  +(Y-X\widehat{A})' \ \mathrm{diag}(\sigma_{T}^{2}) \ (Y-X\widehat{A}) + \underline{S} \right]} \right] \right\}
\end{align*}
\]</span></p>
<p>Focus on the blue part:</p>
<p><span class="math display">\[
\begin{align}
&amp; \quad \quad({A}-\widehat{A})'X' \ \mathrm{diag}(\sigma_{T}^{2}) \ X({A}-\widehat{A}) + ({A}-\underline{A})'\underline{V}^{-1}({A}-\underline{A}) +(Y-X\widehat{A})' \ \mathrm{diag}(\sigma_{T}^{2}) \ (Y-X\widehat{A}) + \underline{S}
\\
&amp;= A'X'\mathrm{diag}(\sigma_{T}^{2})XA - A'X'\mathrm{diag}(\sigma_{T}^{2})X\widehat{A} -\widehat{A}'X'\mathrm{diag}(\sigma_{T}^{2})XA + \underbrace{\widehat{A}'X'\mathrm{diag}(\sigma_{T}^{2})X\widehat{A}}_{\text{cancel out 1}}  + A'\underline{V}^{-1}A -A'\underline{V}^{-1}\underline{A} - \underline{A}'\underline{V}^{-1}A +\underline{A}'\underline{V}^{-1}\underline{A}'
\\
&amp; \qquad + Y'\mathrm{diag}(\sigma_{T}^{2})Y - \underbrace{Y'\mathrm{diag}(\sigma_{T}^{2})X\widehat{A}}_{\text{cancel out 2}}  - \underbrace{\widehat{A}'X'\mathrm{diag}(\sigma_{T}^{2})Y}_{\text{cancel out 2} }  + \underbrace{\widehat{A}'X'\mathrm{diag}(\sigma_{T}^{2})X\widehat{A} }_{\text{cancel out 1}} +\underline{S}
\\
&amp;= \underbrace{A'X'\mathrm{diag}(\sigma_{T}^{2})XA}_{\text{merge 1}}  - A'X'\mathrm{diag}(\sigma_{T}^{2})X\widehat{A} -\widehat{A}'X'\mathrm{diag}(\sigma_{T}^{2})XA  + \underbrace{ A'\underline{V}^{-1}A}_{\text{merge 1}} - A'\underline{V}^{-1}\underline{A} - \underline{A}'\underline{V}^{-1}A +\underline{A}'\underline{V}^{-1}\underline{A}' + Y'\mathrm{diag}(\sigma_{T}^{2})Y  +\underline{S}
\\
&amp; = A' \underbrace{[X'\mathrm{diag}(\sigma_{T}^{2}) X + \underline{V}^{-1}]}_{\overline{V}^{-1}} A - \underbrace{A'X'\mathrm{diag}(\sigma_{T}^{2})X\widehat{A} }_{A'X'\mathrm{diag}(\sigma_{T}^{2})Y}  - \underbrace{\widehat{A}'X'\mathrm{diag}(\sigma_{T}^{2})XA}_{A'X'\mathrm{diag}(\sigma_{T}^{2})Y}    - A'\underline{V}^{-1}\underline{A} - \underline{A}'\underline{V}^{-1}A +\underline{A}'\underline{V}^{-1}\underline{A}' + Y'\mathrm{diag}(\sigma_{T}^{2})Y  +\underline{S}
\\
&amp; = A'\overline{V}^{-1}A - 2A'  [ X'\mathrm{diag}(\sigma_{T}^{2})Y + \underline{V}^{-1}\underline{A} ] + \underline{A}'\underline{V}^{-1}\underline{A}' + Y'\mathrm{diag}(\sigma_{T}^{2})Y  +\underline{S}
\\
&amp; = A'\overline{V}^{-1}A - 2A' \overline{V}^{-1} \underbrace{\overline{V}[X'\mathrm{diag}(\sigma_{T}^{2})Y + \underline{V}^{-1}\underline{A} ]}_{\overline{A}}  + \underline{A}'\underline{V}^{-1}\underline{A}' + Y'\mathrm{diag}(\sigma_{T}^{2})Y  +\underline{S}
\\
&amp; = A'\overline{V}^{-1}A - 2A'\overline{V}^{-1}\overline{A} +  \underline{A}'\underline{V}^{-1}\underline{A}' + Y'\mathrm{diag}(\sigma_{T}^{2})Y  +\underline{S}
\\
&amp; = A'\overline{V}^{-1}A - 2A'\overline{V}^{-1}\overline{A} + [ \overline{A}'\overline{V}^{-1}\overline{A} -  \overline{A}'\overline{V}^{-1}\overline{A} ]+ \underline{A}'\underline{V}^{-1}\underline{A}' + Y'\mathrm{diag}(\sigma_{T}^{2})Y  +\underline{S} \\
&amp; = \underbrace{ A'\overline{V}^{-1}A - 2A'\overline{V}^{-1}\overline{A} + \overline{A}'\overline{V}^{-1}\overline{A}}_{\text{MN part}}  \quad
\underbrace{-  \overline{A}'\overline{V}^{-1}\overline{A} + \underline{A}'\underline{V}^{-1}\underline{A}' + Y'\mathrm{diag}(\sigma_{T}^{2})Y  +\underline{S}}_{\text{IW part}\quad \overline{S}}
\\
\\
\\
&amp; \qquad \text{where} \ A'X'\mathrm{diag}(\sigma_{T}^{2})X\widehat{A} = A'X'\mathrm{diag}(\sigma_{T}^{2})X(X'X)^{-1}X'Y=A'X'\mathrm{diag}(\sigma_{T}^{2})Y
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\overline{V} &amp;= (X'\mathrm{diag}(\sigma_{T}^{2})^{-1}X + \underline{V}^{-1})^{-1}\\
\overline{A} &amp;= \overline{V}[X'\mathrm{diag}(\sigma_{T}^{2})^{-1}Y+\underline{V}^{-1}\underline{A}] \\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \underline{S}+Y'\mathrm{diag}(\sigma_{T}^{2})^{-1}Y+\underline{A}'\underline{V}^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A}
\end{align}
\]</span></p>
<p><strong>Step 3</strong>:</p>
<p>According to Bayesian Autoregressions website <span class="citation" data-cites="wozniak2023">(<a href="#ref-wozniak2023" role="doc-biblioref">WOZNIAK 2023</a>)</span>, as <span class="math inline">\(\overline{A}\)</span>, <span class="math inline">\(\overline{V}\)</span>, <span class="math inline">\(\overline{S}\)</span> and <span class="math inline">\(\overline{v}\)</span> are specified:</p>
<p>To obtain a sample of <span class="math inline">\(S\)</span> draws from the posterior distribution:</p>
<ol type="1">
<li><p>Sample <span class="math inline">\(S\)</span> draws from the marginal posterior distribution for <span class="math inline">\(\Sigma^{(s)}\)</span> given by <span class="math inline">\(\mathcal{IW}_{10}(\overline{S}, \overline{v})\)</span>, and collect the draws in <span class="math inline">\(\{\Sigma^{(s)}\}_{s=1}^{S}\)</span></p></li>
<li><p>For each draw <span class="math inline">\(\Sigma^{(s)}\)</span> for <span class="math inline">\(s=1,\dots,S\)</span> sample the corresponding draw of <span class="math inline">\(A^{(s)}\)</span> from <span class="math inline">\(\mathcal{MN}_{K\times 10}(\overline{A}, \Sigma^{(s)},\overline{V})\)</span></p></li>
<li><p>Draw the logarithmic volatilities <span class="math inline">\(H\)</span> using a function designed to handle tridiagonal precision matrices, incorporating both the prior on <span class="math inline">\(h_0\)</span> and the conditional distributions of the log-volatilities</p></li>
<li><p>Compute <span class="math inline">\(\sigma^2\)</span> from the exponential transformation of the drawn logarithmic volatilities <span class="math inline">\(H\)</span>.</p></li>
<li><p>Draw <span class="math inline">\(\sigma_v^2\)</span> from the inverse gamma distribution, considering the sum of squared differences between successive <span class="math inline">\(H\)</span> values and <span class="math inline">\(h_0\)</span></p></li>
<li><p>Update the State Variable <span class="math inline">\(s\)</span>:</p></li>
</ol>
<p>Output is the sample draws from the joint posterior distribution <span class="math inline">\(\left\{ {A^{(s)}, \Sigma^{(s)}},H^{(s)}, \sigma^{2(s)},h_0^{(s)}, \sigma_v^{2(s)}, s^{(s)} \right\}^{S}_{s=1}\)</span>.</p>
<p>Function below is <code>posterior.draws.hetero</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior sample draw function for heteroskedasticity on basic </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>posterior.draws.hetero <span class="ot">=</span> <span class="cf">function</span> (S, Y, X){</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Pre-setup </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">=</span> <span class="fu">ncol</span>(Y) </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  t             <span class="ot">=</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  p             <span class="ot">=</span> <span class="fu">frequency</span>(Y)                        </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  A.hat         <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Y</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  Sigma.hat     <span class="ot">=</span> <span class="fu">t</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">%*%</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">/</span><span class="fu">nrow</span>(Y)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  T             <span class="ot">=</span> <span class="fu">dim</span>(Y)[<span class="dv">1</span>] <span class="co"># 133</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  K             <span class="ot">=</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>] <span class="co"># 41</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  H             <span class="ot">=</span> <span class="fu">diag</span>(T)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sdiag</span>(H,<span class="sc">-</span><span class="dv">1</span>)   <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  HH            <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(T)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sdiag</span>(HH,<span class="sc">-</span><span class="dv">1</span>)  <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sdiag</span>(HH,<span class="dv">1</span>)   <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prior distribution (with Minnesota prior)</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  A.prior           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(A.hat),<span class="fu">ncol</span>(A.hat))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  A.prior[<span class="dv">2</span><span class="sc">:</span>t,]     <span class="ot">=</span> <span class="fu">diag</span>(N)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  V.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  S.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(Sigma.hat))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  nu.prior          <span class="ot">=</span> N <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  HH                <span class="ot">=</span> HH</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  h0.m              <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  h0.v              <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  sigmav.s          <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  sigmav.nu         <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define posterior</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  posteriors    <span class="ot">=</span> <span class="fu">list</span>(                        </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">H           =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,T,S),</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma2      =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,T,S),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">s           =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,T,S),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">h0          =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,S),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.v2    =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,S),</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">A           =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>((<span class="dv">1</span> <span class="sc">+</span> N <span class="sc">*</span> p), N, S)),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigma       =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N, N, S))</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define auxiliary</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  aux        <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y        =</span> Y,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">X        =</span> X,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">H        =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, T, <span class="dv">1</span>),</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">h0       =</span> <span class="dv">0</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.v2 =</span> <span class="dv">1</span>,</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">s        =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, T, <span class="dv">1</span>),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">A        =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, K, N),</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigma    =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, N),             </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma2   =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, T, <span class="dv">1</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>   <span class="co"># ----------------------posterior.draws.hetero------------------------------</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>      <span class="co"># normal-inverse Wishard posterior </span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>      V.bar.inv              <span class="ot">=</span> <span class="fu">t</span>(aux<span class="sc">$</span>X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">as.vector</span>(aux<span class="sc">$</span>sigma2))<span class="sc">%*%</span>aux<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span> <span class="fu">diag</span>(V.prior))</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>      V.bar                  <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>      A.bar                  <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(aux<span class="sc">$</span>X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">as.vector</span>(aux<span class="sc">$</span>sigma2))<span class="sc">%*%</span>aux<span class="sc">$</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>( V.prior))<span class="sc">%*%</span>A.prior) </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>      nu.bar                 <span class="ot">=</span> T <span class="sc">+</span> nu.prior</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>      S.bar                  <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(aux<span class="sc">$</span>Y)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">as.vector</span>(aux<span class="sc">$</span>sigma2))<span class="sc">%*%</span>aux<span class="sc">$</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>      S.bar.inv              <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>      S.bar.inv              <span class="ot">=</span> <span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">t</span>(S.bar.inv) <span class="sc">+</span> S.bar.inv) <span class="co"># positive-definite</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>      <span class="co"># posterior draws for A and Sigma</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior.IW     <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior.draw   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior.IW, <span class="dv">3</span> ,solve)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>Sigma              <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior.draw,<span class="fu">c</span>(N,N,<span class="dv">1</span>))</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>      A.norm                 <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(K,N,<span class="dv">1</span>))),<span class="fu">c</span>(K,N,<span class="dv">1</span>))</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>      L                      <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>A                  <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.norm[,,<span class="dv">1</span>]<span class="sc">%*%</span><span class="fu">chol</span>(aux<span class="sc">$</span>Sigma[,,<span class="dv">1</span>])</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>      <span class="co"># posterior draw for sigma2   </span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>      N             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">2</span>] <span class="co"># 10</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>      alpha.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.92677</span>,<span class="fl">1.34744</span>,<span class="fl">0.73504</span>,<span class="fl">0.02266</span>,<span class="dv">0</span><span class="fl">-0.85173</span>,<span class="sc">-</span><span class="fl">1.97278</span>,<span class="sc">-</span><span class="fl">3.46788</span>,<span class="sc">-</span><span class="fl">5.55246</span>,<span class="sc">-</span><span class="fl">8.68384</span>,<span class="sc">-</span><span class="fl">14.65000</span>)</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>      sigma.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.11265</span>,<span class="fl">0.17788</span>,<span class="fl">0.26768</span>,<span class="fl">0.40611</span>,<span class="fl">0.62699</span>,<span class="fl">0.98583</span>,<span class="fl">1.57469</span>,<span class="fl">2.54498</span>,<span class="fl">4.16591</span>,<span class="fl">7.33342</span>)</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>      pi.st         <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.00609</span>,<span class="fl">0.04775</span>,<span class="fl">0.13057</span>,<span class="fl">0.20674</span>,<span class="fl">0.22715</span>,<span class="fl">0.18842</span>,<span class="fl">0.12047</span>,<span class="fl">0.05591</span>,<span class="fl">0.01575</span>,<span class="fl">0.00115</span>)</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>      Lambda        <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">chol</span>(aux<span class="sc">$</span>Sigma[,,<span class="dv">1</span>]))</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>      Z             <span class="ot">=</span> <span class="fu">rowSums</span>( ( aux<span class="sc">$</span>Y <span class="sc">-</span> aux<span class="sc">$</span>X <span class="sc">%*%</span> aux<span class="sc">$</span>A ) <span class="sc">%*%</span> Lambda ) <span class="sc">/</span> <span class="fu">sqrt</span>(N)</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>      Y.tilde       <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">log</span>((Z <span class="sc">+</span> <span class="fl">0.0000001</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>      Ytilde.alpha  <span class="ot">=</span> <span class="fu">as.matrix</span>(Y.tilde <span class="sc">-</span> alpha.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling initial condition</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>      V.h0.bar      <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">/</span> h0.v) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>      m.h0.bar      <span class="ot">=</span> V.h0.bar<span class="sc">*</span>((h0.m <span class="sc">/</span> h0.v) <span class="sc">+</span> (aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>      h0.draw       <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> m.h0.bar, <span class="at">sd =</span> <span class="fu">sqrt</span>(V.h0.bar))</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>h0        <span class="ot">=</span> h0.draw</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling sigma.v2</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>      sigma.v2.s    <span class="ot">=</span> sigmav.s <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">c</span>(aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">-</span> aux<span class="sc">$</span>h0, <span class="fu">diff</span>(aux<span class="sc">$</span>H))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>      sigma.v2.draw <span class="ot">=</span> sigma.v2.s <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, sigmav.nu <span class="sc">+</span> T)</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>sigma.v2  <span class="ot">=</span> sigma.v2.draw</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling auxiliary states</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>      Pr.tmp        <span class="ot">=</span> <span class="fu">simplify2array</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(x){</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dnorm</span>(Y.tilde, <span class="at">mean =</span> <span class="fu">as.vector</span>(aux<span class="sc">$</span>H <span class="sc">+</span> alpha.st[x]), <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma.st[x]), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">log</span>(pi.st[x])</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>      }))</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>      Pr            <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr.tmp, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)))}))</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>      s.cum         <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr, <span class="dv">1</span>, cumsum))</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>      r             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">runif</span>(T), <span class="dv">10</span>), <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>      ss            <span class="ot">=</span> <span class="fu">apply</span>(s.cum <span class="sc">&lt;</span> r, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>s         <span class="ot">=</span> <span class="fu">as.matrix</span>(ss)</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling log-volatilities using functions for tridiagonal precision matrix</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>      Sigma.s.inv   <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>      D.inv         <span class="ot">=</span> Sigma.s.inv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2) <span class="sc">*</span> HH</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>      b             <span class="ot">=</span> <span class="fu">as.matrix</span>(Ytilde.alpha <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)] <span class="sc">+</span> (aux<span class="sc">$</span>h0<span class="sc">/</span>aux<span class="sc">$</span>sigma.v2)<span class="sc">*</span><span class="fu">diag</span>(T)[,<span class="dv">1</span>])</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>      lead.diag     <span class="ot">=</span> <span class="fu">diag</span>(D.inv)</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>      sub.diag      <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.inv, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>      D.chol        <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">trichol</span>(<span class="at">ld =</span> lead.diag, <span class="at">sd =</span> sub.diag)</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>      D.L           <span class="ot">=</span> <span class="fu">diag</span>(D.chol<span class="sc">$</span>ld)</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>      mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.L,<span class="sc">-</span><span class="dv">1</span>) <span class="ot">=</span> D.chol<span class="sc">$</span>sd</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>      x             <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(T))</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>      a             <span class="ot">=</span> <span class="fu">forwardsolve</span>(D.L, b)</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>      draw          <span class="ot">=</span> <span class="fu">backsolve</span>(<span class="fu">t</span>(D.L), a <span class="sc">+</span> x)</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>H         <span class="ot">=</span> <span class="fu">as.matrix</span>(draw)</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>sigma2    <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">exp</span>(draw))</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>      <span class="co"># output list</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>H[,s]             <span class="ot">=</span> aux<span class="sc">$</span>H</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>sigma2[,s]        <span class="ot">=</span> aux<span class="sc">$</span>sigma2</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>s[,s]             <span class="ot">=</span> aux<span class="sc">$</span>s</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>h0[s]             <span class="ot">=</span> aux<span class="sc">$</span>h0</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>sigma.v2[s]       <span class="ot">=</span> aux<span class="sc">$</span>sigma.v2</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>A[,,s]            <span class="ot">=</span> aux<span class="sc">$</span>A</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>Sigma[,,s]        <span class="ot">=</span> aux<span class="sc">$</span>Sigma</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(posteriors)</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 10 Mean Values of A.posterior.het.simu (head 11) </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.002700</td>
<td style="text-align: center;">0.058578</td>
<td style="text-align: center;">0.006291</td>
<td style="text-align: center;">0.482206</td>
<td style="text-align: center;">-0.248578</td>
<td style="text-align: center;">0.002801</td>
<td style="text-align: center;">-0.009768</td>
<td style="text-align: center;">0.003049</td>
<td style="text-align: center;">0.007944</td>
<td style="text-align: center;">0.023111</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.999932</td>
<td style="text-align: center;">0.000774</td>
<td style="text-align: center;">-0.000292</td>
<td style="text-align: center;">-0.008386</td>
<td style="text-align: center;">0.008515</td>
<td style="text-align: center;">-0.000124</td>
<td style="text-align: center;">0.000404</td>
<td style="text-align: center;">0.000847</td>
<td style="text-align: center;">0.000898</td>
<td style="text-align: center;">-0.000155</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.002064</td>
<td style="text-align: center;">0.712091</td>
<td style="text-align: center;">-0.000395</td>
<td style="text-align: center;">0.097315</td>
<td style="text-align: center;">-0.004102</td>
<td style="text-align: center;">0.000280</td>
<td style="text-align: center;">0.001774</td>
<td style="text-align: center;">0.001894</td>
<td style="text-align: center;">-0.001601</td>
<td style="text-align: center;">-0.004907</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000227</td>
<td style="text-align: center;">0.000268</td>
<td style="text-align: center;">1.000436</td>
<td style="text-align: center;">0.037701</td>
<td style="text-align: center;">-0.021641</td>
<td style="text-align: center;">0.000325</td>
<td style="text-align: center;">-0.001120</td>
<td style="text-align: center;">0.000396</td>
<td style="text-align: center;">0.001211</td>
<td style="text-align: center;">0.002370</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000348</td>
<td style="text-align: center;">0.016616</td>
<td style="text-align: center;">0.000266</td>
<td style="text-align: center;">0.972559</td>
<td style="text-align: center;">-0.016669</td>
<td style="text-align: center;">0.001750</td>
<td style="text-align: center;">0.002311</td>
<td style="text-align: center;">0.003648</td>
<td style="text-align: center;">-0.000831</td>
<td style="text-align: center;">0.000150</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.000338</td>
<td style="text-align: center;">0.017375</td>
<td style="text-align: center;">0.000170</td>
<td style="text-align: center;">-0.078693</td>
<td style="text-align: center;">0.982306</td>
<td style="text-align: center;">-0.000525</td>
<td style="text-align: center;">0.001815</td>
<td style="text-align: center;">0.001300</td>
<td style="text-align: center;">0.001642</td>
<td style="text-align: center;">-0.003012</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.000225</td>
<td style="text-align: center;">-0.012430</td>
<td style="text-align: center;">-0.001183</td>
<td style="text-align: center;">-0.052991</td>
<td style="text-align: center;">0.044527</td>
<td style="text-align: center;">0.999250</td>
<td style="text-align: center;">0.000386</td>
<td style="text-align: center;">0.003283</td>
<td style="text-align: center;">0.002420</td>
<td style="text-align: center;">-0.002224</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000212</td>
<td style="text-align: center;">0.000229</td>
<td style="text-align: center;">0.000064</td>
<td style="text-align: center;">0.003434</td>
<td style="text-align: center;">-0.001124</td>
<td style="text-align: center;">0.000696</td>
<td style="text-align: center;">0.995941</td>
<td style="text-align: center;">0.000134</td>
<td style="text-align: center;">-0.000232</td>
<td style="text-align: center;">-0.000109</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000008</td>
<td style="text-align: center;">0.003371</td>
<td style="text-align: center;">-0.000450</td>
<td style="text-align: center;">-0.024715</td>
<td style="text-align: center;">0.027849</td>
<td style="text-align: center;">-0.000222</td>
<td style="text-align: center;">0.000276</td>
<td style="text-align: center;">0.990792</td>
<td style="text-align: center;">0.001639</td>
<td style="text-align: center;">0.001454</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000142</td>
<td style="text-align: center;">0.029070</td>
<td style="text-align: center;">0.000837</td>
<td style="text-align: center;">0.035402</td>
<td style="text-align: center;">-0.043173</td>
<td style="text-align: center;">0.000855</td>
<td style="text-align: center;">0.005054</td>
<td style="text-align: center;">0.005346</td>
<td style="text-align: center;">0.993729</td>
<td style="text-align: center;">-0.001910</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.000059</td>
<td style="text-align: center;">-0.004906</td>
<td style="text-align: center;">-0.000058</td>
<td style="text-align: center;">-0.018559</td>
<td style="text-align: center;">0.020761</td>
<td style="text-align: center;">0.001158</td>
<td style="text-align: center;">0.000649</td>
<td style="text-align: center;">0.003824</td>
<td style="text-align: center;">-0.004598</td>
<td style="text-align: center;">0.995535</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 11 Mean Values of Sigma.posterior.het.simu </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1.0e-06</td>
<td style="text-align: center;">-0.000005</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">0.000004</td>
<td style="text-align: center;">-0.000014</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">0.000001</td>
<td style="text-align: center;">-0.000001</td>
<td style="text-align: center;">0.0e+00</td>
</tr>
<tr class="even">
<td style="text-align: center;">-5.0e-06</td>
<td style="text-align: center;">0.010561</td>
<td style="text-align: center;">-2.0e-06</td>
<td style="text-align: center;">0.000643</td>
<td style="text-align: center;">-0.001138</td>
<td style="text-align: center;">-6.7e-05</td>
<td style="text-align: center;">2.6e-05</td>
<td style="text-align: center;">0.000106</td>
<td style="text-align: center;">-0.000129</td>
<td style="text-align: center;">2.0e-05</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">-0.000002</td>
<td style="text-align: center;">3.0e-06</td>
<td style="text-align: center;">0.000009</td>
<td style="text-align: center;">-0.000034</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">1.0e-06</td>
<td style="text-align: center;">0.000001</td>
<td style="text-align: center;">-0.000004</td>
<td style="text-align: center;">0.0e+00</td>
</tr>
<tr class="even">
<td style="text-align: center;">4.0e-06</td>
<td style="text-align: center;">0.000643</td>
<td style="text-align: center;">9.0e-06</td>
<td style="text-align: center;">0.004387</td>
<td style="text-align: center;">-0.000256</td>
<td style="text-align: center;">-5.4e-05</td>
<td style="text-align: center;">-6.7e-05</td>
<td style="text-align: center;">-0.000078</td>
<td style="text-align: center;">-0.000073</td>
<td style="text-align: center;">5.5e-05</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-1.4e-05</td>
<td style="text-align: center;">-0.001138</td>
<td style="text-align: center;">-3.4e-05</td>
<td style="text-align: center;">-0.000256</td>
<td style="text-align: center;">0.003058</td>
<td style="text-align: center;">-1.3e-05</td>
<td style="text-align: center;">-7.9e-05</td>
<td style="text-align: center;">-0.000083</td>
<td style="text-align: center;">0.000052</td>
<td style="text-align: center;">-4.0e-05</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">-0.000067</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">-0.000054</td>
<td style="text-align: center;">-0.000013</td>
<td style="text-align: center;">9.0e-06</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">-0.000002</td>
<td style="text-align: center;">0.000002</td>
<td style="text-align: center;">-2.0e-06</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">0.000026</td>
<td style="text-align: center;">1.0e-06</td>
<td style="text-align: center;">-0.000067</td>
<td style="text-align: center;">-0.000079</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">8.4e-05</td>
<td style="text-align: center;">0.000032</td>
<td style="text-align: center;">-0.000011</td>
<td style="text-align: center;">-2.3e-05</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.0e-06</td>
<td style="text-align: center;">0.000106</td>
<td style="text-align: center;">1.0e-06</td>
<td style="text-align: center;">-0.000078</td>
<td style="text-align: center;">-0.000083</td>
<td style="text-align: center;">-2.0e-06</td>
<td style="text-align: center;">3.2e-05</td>
<td style="text-align: center;">0.000178</td>
<td style="text-align: center;">-0.000035</td>
<td style="text-align: center;">-4.7e-05</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-1.0e-06</td>
<td style="text-align: center;">-0.000129</td>
<td style="text-align: center;">-4.0e-06</td>
<td style="text-align: center;">-0.000073</td>
<td style="text-align: center;">0.000052</td>
<td style="text-align: center;">2.0e-06</td>
<td style="text-align: center;">-1.1e-05</td>
<td style="text-align: center;">-0.000035</td>
<td style="text-align: center;">0.000179</td>
<td style="text-align: center;">3.8e-05</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">0.000020</td>
<td style="text-align: center;">0.0e+00</td>
<td style="text-align: center;">0.000055</td>
<td style="text-align: center;">-0.000040</td>
<td style="text-align: center;">-2.0e-06</td>
<td style="text-align: center;">-2.3e-05</td>
<td style="text-align: center;">-0.000047</td>
<td style="text-align: center;">0.000038</td>
<td style="text-align: center;">7.3e-05</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Histograms Trace Plots Basic Hetero-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 14 Histograms and trace plots on key variables using basic hetero model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Figure 15 displays a 3D visualization that, as anticipated, exhibits confidence intervals expanding from narrow to wide. Furthermore, the confidence intervals appear narrower than those in the model without heteroscedasticity, suggesting that incorporating heteroscedasticity is efficacious.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/3d Forecasting Graph on Basic Hetero-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 15 3D forecasting graph on basic model with heteroskedasticity</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As analyzed above, Figure 16 also shows improved forecasts, with the predicted inflation rate gradually declining to 2-3% over the next eight periods. Additionally, people’s expectations of inflation are also decreasing in sync, aligning with the initial inquiry.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Basic Model with hetero Key Data Plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 16 Basic Model with heteroskedasticity key data plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extended-model-with-heteroskedasticity" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="extended-model-with-heteroskedasticity"><span class="header-section-number">6.2</span> Extended Model with Heteroskedasticity</h3>
<p>Similar like before, the model extension base on a hierarchical model. The gamma distribution on the Minnesota shrinkage parameter lambda <span class="math inline">\(\lambda\)</span> is introduced to adjust <span class="math inline">\(V\)</span>.</p>
<p><strong>Step 1</strong>: Prior distribution is presented below. <span class="math inline">\(\underline{A}\)</span>, <span class="math inline">\(\underline{V}\)</span>, <span class="math inline">\(\underline{S}\)</span>, <span class="math inline">\(\underline{\nu}\)</span> by Minnesota shrinkage parameter lambda <span class="math inline">\(\lambda\)</span> will be simplified.</p>
<p><span class="math display">\[
\begin{align}
p(A,\Sigma, \lambda |Y,X) &amp;\propto L(A,\Sigma | Y,X) \ p(A,\Sigma, \lambda) \\
&amp;\propto L(A,\Sigma | Y,X)  \ p(A |\Sigma, \lambda) \ p(\Sigma) \ p(\lambda)
\end{align}
\]</span></p>
<p>where, each <span class="math inline">\(p(A |\Sigma, k)\)</span>, <span class="math inline">\(p(\Sigma)\)</span>, <span class="math inline">\(p(k)\)</span> is specified below:</p>
<p><span class="math display">\[
\begin{align}
A |\Sigma, \lambda &amp;\sim \mathcal{MN}_{K\times N}(\underline{A}, \Sigma, \lambda\underline{V}) \\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S},\underline{\nu}) \\
\lambda &amp;\sim \mathcal{Gamma}(\underline{k_{\lambda}}, \underline{\theta_{\lambda}} ) \\
\end{align}
\]</span></p>
<p><strong>Step 2</strong>: All kernal shown below</p>
<p><span class="math display">\[
\begin{align}
L(A,\Sigma | Y,X) &amp;= \mathrm{det} (\Sigma)^{-\frac{T}{2}}\times \mathrm{exp}\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1}(A-\widehat{A})'X' \mathrm{diag}(\sigma_{T}^{2}) X (A-\widehat{A})\right]\right\} \times \mathrm{exp}\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1}(Y-X\widehat{A})' \mathrm{diag}(\sigma_{T}^{2})(Y-X\widehat{A})\right]\right\}
\\
p(A |\Sigma, \lambda) &amp;= \mathrm{det} (\Sigma)^{-\frac{K}{2}} \mathrm{det}(\lambda \underline{V} )^{-\frac{N}{2}}\mathrm{exp}\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1} (A-\underline{A})' (\lambda\underline{V})^{-1} (A-\underline{A})\right]\right\}
\\
p(\Sigma) &amp;= \mathrm{det}(\Sigma)^{\frac{\underline{\nu}+N+1}{2}} \mathrm{exp}\left\{ -\frac{1}{2} \mathrm{tr}\left[ \Sigma^{-1} \underline{S}\right]\right\}  
\\
p(\lambda) &amp;= \lambda ^{\underline{k_{\lambda}}-1}e^{-\frac{\lambda}{\underline{\theta_{\lambda}}}}
\end{align}
\]</span></p>
<p>Similar like before,</p>
<ul>
<li>The kernel of the fully conditional posterior distribution of <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span>:</li>
</ul>
<p><span class="math display">\[
\begin{align}
\overline{V} &amp;= (X'\mathrm{diag}(\sigma_{T}^{2})^{-1}X + (\lambda\underline{V})^{-1})^{-1}\\
\overline{A} &amp;= \overline{V}[X'\mathrm{diag}(\sigma_{T}^{2})^{-1}Y+(\lambda\underline{V})^{-1}\underline{A}] \\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \underline{S}+Y'\mathrm{diag}(\sigma_{T}^{2})^{-1}Y+\underline{A}'(\lambda\underline{V})^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A}
\end{align}
\]</span></p>
<ul>
<li>The kernel of the fully conditional posterior distribution of <span class="math inline">\(\lambda\)</span>:</li>
</ul>
<p><span class="math display">\[
\begin{align}
\overline{a} &amp;= \frac{2}{\underline{\theta_{\lambda}} }
\\
\overline{b} &amp;= \mathrm{tr}  \left[ \Sigma^{-1} (A-\underline{A})' (\underline{V})^{-1} (A-\underline{A})\right]
\\
\overline{p} &amp;= -\frac{KN}{2} + \underline{k_{\lambda}}
\end{align}
\]</span></p>
<p><strong>Step 3</strong>: As <span class="math inline">\(\overline{A}\)</span>, <span class="math inline">\(\overline{V}\)</span>, <span class="math inline">\(\overline{S}\)</span>, <span class="math inline">\(\overline{v}\)</span>, <span class="math inline">\(\overline{a}\)</span>, <span class="math inline">\(\overline{b}\)</span>, <span class="math inline">\(\overline{p}\)</span> are specified:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>invfunc <span class="ot">=</span> <span class="cf">function</span>(inv){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>eigen_decomp <span class="ot">&lt;-</span> <span class="fu">eigen</span>(inv, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>      eigen_decomp<span class="sc">$</span>values[eigen_decomp<span class="sc">$</span>values <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>      inv <span class="ot">&lt;-</span> eigen_decomp<span class="sc">$</span>vectors <span class="sc">%*%</span> <span class="fu">diag</span>(eigen_decomp<span class="sc">$</span>values) <span class="sc">%*%</span> <span class="fu">t</span>(eigen_decomp<span class="sc">$</span>vectors)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Function below is <code>posterior.draws.exten.hetero</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior sample draw function for heteroskedasticity on entended model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>posterior.draws.exten.hetero <span class="ot">=</span> <span class="cf">function</span> (total_S, Y, X){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Pre-setup </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">=</span> <span class="fu">ncol</span>(Y) <span class="co"># 10</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  t             <span class="ot">=</span> N <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  p             <span class="ot">=</span> <span class="fu">frequency</span>(Y)  <span class="co"># 4                     </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  A.hat         <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Y</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  Sigma.hat     <span class="ot">=</span> <span class="fu">t</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">%*%</span>(Y<span class="sc">-</span>X<span class="sc">%*%</span>A.hat)<span class="sc">/</span><span class="fu">nrow</span>(Y)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  T             <span class="ot">=</span> <span class="fu">dim</span>(Y)[<span class="dv">1</span>] <span class="co"># 133</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  K             <span class="ot">=</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>] <span class="co"># 41</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  H             <span class="ot">=</span> <span class="fu">diag</span>(T)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sdiag</span>(H,<span class="sc">-</span><span class="dv">1</span>)   <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  HH            <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(T)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sdiag</span>(HH,<span class="sc">-</span><span class="dv">1</span>)  <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sdiag</span>(HH,<span class="dv">1</span>)   <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prior distribution (with Minnesota prior)</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  A.prior           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(A.hat),<span class="fu">ncol</span>(A.hat))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  A.prior[<span class="dv">2</span><span class="sc">:</span>t,]     <span class="ot">=</span> <span class="fu">diag</span>(N)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  V.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  S.prior           <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(Sigma.hat))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  nu.prior          <span class="ot">=</span> N <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  lambda.priors     <span class="ot">=</span> <span class="fu">list</span>(<span class="at">k =</span> <span class="dv">1</span>, <span class="at">theta =</span> .<span class="dv">1</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  HH                <span class="ot">=</span> HH</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  h0.m              <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  h0.v              <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  sigmav.s          <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  sigmav.nu         <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define posterior</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  posteriors    <span class="ot">=</span> <span class="fu">list</span>(                        </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">H           =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, T, total_S),</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma2      =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, T, total_S),</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">s           =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, T, total_S),</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">h0          =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, total_S),</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.v2    =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, total_S),</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">A           =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>((<span class="dv">1</span> <span class="sc">+</span> N <span class="sc">*</span> p), N, total_S)),</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigma       =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N, N, total_S)),</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda      =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, total_S)  </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define auxiliary</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  aux        <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y        =</span> Y,</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">X        =</span> X,</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">H        =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, T, <span class="dv">1</span>),</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">h0       =</span> <span class="dv">0</span>,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.v2 =</span> <span class="dv">1</span>,</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">s        =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, T, <span class="dv">1</span>),</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">A        =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, K, N),</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigma    =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, N),             </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma2   =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, T, <span class="dv">1</span>),</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda   =</span> <span class="dv">10</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>   <span class="co"># ----------------------posterior.draws.exten.hetero------------------------------</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_S){ </span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normal-inverse Wishard posterior </span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>      V.bar.inv              <span class="ot">=</span> <span class="fu">t</span>(aux<span class="sc">$</span>X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">as.vector</span>(aux<span class="sc">$</span>sigma2))<span class="sc">%*%</span>aux<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">solve</span>(aux<span class="sc">$</span>lambda<span class="sc">*</span> V.prior)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>      V.bar.inv              <span class="ot">=</span> <span class="fu">invfunc</span>(V.bar.inv)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>      V.bar                  <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>      A.bar                  <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(aux<span class="sc">$</span>X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">as.vector</span>(aux<span class="sc">$</span>sigma2))<span class="sc">%*%</span>aux<span class="sc">$</span>Y <span class="sc">+</span> <span class="fu">solve</span>(aux<span class="sc">$</span>lambda <span class="sc">*</span> V.prior)<span class="sc">%*%</span>A.prior) </span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>      nu.bar                 <span class="ot">=</span> T <span class="sc">+</span> nu.prior</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>      S.bar                  <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(aux<span class="sc">$</span>Y)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">as.vector</span>(aux<span class="sc">$</span>sigma2))<span class="sc">%*%</span>aux<span class="sc">$</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">solve</span>(aux<span class="sc">$</span>lambda <span class="sc">*</span> V.prior)<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar </span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>      S.bar                  <span class="ot">=</span> <span class="fu">invfunc</span>(S.bar)</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>      S.bar.inv              <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>      <span class="co"># S.bar.inv              = 0.5 * (t(S.bar.inv) + S.bar.inv) # positive-definite</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posterior draws for A and Sigma</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior.IW     <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior.draw   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior.IW, <span class="dv">3</span> ,solve)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>Sigma              <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior.draw,<span class="fu">c</span>(N,N,<span class="dv">1</span>))</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(aux<span class="sc">$</span>Sigma)[<span class="dv">3</span>]) {</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>          eigen_decomp <span class="ot">&lt;-</span> <span class="fu">eigen</span>(aux<span class="sc">$</span>Sigma[, , i], <span class="at">symmetric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>          eigen_decomp<span class="sc">$</span>values[eigen_decomp<span class="sc">$</span>values <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>          aux<span class="sc">$</span>Sigma[, , i] <span class="ot">&lt;-</span> eigen_decomp<span class="sc">$</span>vectors <span class="sc">%*%</span> <span class="fu">diag</span>(eigen_decomp<span class="sc">$</span>values) <span class="sc">%*%</span> <span class="fu">t</span>(eigen_decomp<span class="sc">$</span>vectors)</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>      A.norm                 <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(K,N,<span class="dv">1</span>))),<span class="fu">c</span>(K,N,<span class="dv">1</span>))</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>      L                      <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))      </span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>A                  <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.norm[,,<span class="dv">1</span>]<span class="sc">%*%</span><span class="fu">chol</span>(aux<span class="sc">$</span>Sigma[,,<span class="dv">1</span>])</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posterior draws for lambda</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>      lambda.p <span class="ot">=</span> lambda.priors<span class="sc">$</span>k <span class="sc">-</span> (K <span class="sc">*</span> N) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>      diff_A <span class="ot">=</span> aux<span class="sc">$</span>A <span class="sc">-</span> A.prior</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>      product <span class="ot">=</span> <span class="fu">t</span>(diff_A) <span class="sc">%*%</span> <span class="fu">solve</span>(V.prior) <span class="sc">%*%</span> diff_A</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>      chi.b <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">diag</span>(aux<span class="sc">$</span>Sigma[,,<span class="dv">1</span>] <span class="sc">%*%</span> product))</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>      psi.a <span class="ot">=</span> <span class="dv">2</span> <span class="sc">/</span> lambda.priors<span class="sc">$</span>theta</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>      lambda.draw <span class="ot">=</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">lambda =</span> lambda.p, <span class="at">chi =</span> chi.b, <span class="at">psi =</span> psi.a)</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>lambda <span class="ot">=</span> lambda.draw</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>      <span class="co"># posterior draw for sigma2   </span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>      N             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">2</span>] <span class="co"># 10</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>      alpha.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.92677</span>,<span class="fl">1.34744</span>,<span class="fl">0.73504</span>,<span class="fl">0.02266</span>,<span class="dv">0</span><span class="fl">-0.85173</span>,<span class="sc">-</span><span class="fl">1.97278</span>,<span class="sc">-</span><span class="fl">3.46788</span>,<span class="sc">-</span><span class="fl">5.55246</span>,<span class="sc">-</span><span class="fl">8.68384</span>,<span class="sc">-</span><span class="fl">14.65000</span>)</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>      sigma.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.11265</span>,<span class="fl">0.17788</span>,<span class="fl">0.26768</span>,<span class="fl">0.40611</span>,<span class="fl">0.62699</span>,<span class="fl">0.98583</span>,<span class="fl">1.57469</span>,<span class="fl">2.54498</span>,<span class="fl">4.16591</span>,<span class="fl">7.33342</span>)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>      pi.st         <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.00609</span>,<span class="fl">0.04775</span>,<span class="fl">0.13057</span>,<span class="fl">0.20674</span>,<span class="fl">0.22715</span>,<span class="fl">0.18842</span>,<span class="fl">0.12047</span>,<span class="fl">0.05591</span>,<span class="fl">0.01575</span>,<span class="fl">0.00115</span>)</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>      Lambda        <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">chol</span>(aux<span class="sc">$</span>Sigma[,,<span class="dv">1</span>]))</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>      Z             <span class="ot">=</span> <span class="fu">rowSums</span>( ( aux<span class="sc">$</span>Y <span class="sc">-</span> aux<span class="sc">$</span>X <span class="sc">%*%</span> aux<span class="sc">$</span>A ) <span class="sc">%*%</span> Lambda ) <span class="sc">/</span> <span class="fu">sqrt</span>(N)</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>      Y.tilde       <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">log</span>((Z <span class="sc">+</span> <span class="fl">0.0000001</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>      Ytilde.alpha  <span class="ot">=</span> <span class="fu">as.matrix</span>(Y.tilde <span class="sc">-</span> alpha.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling initial condition</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>      V.h0.bar      <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">/</span> h0.v) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>      m.h0.bar      <span class="ot">=</span> V.h0.bar<span class="sc">*</span>((h0.m <span class="sc">/</span> h0.v) <span class="sc">+</span> (aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>      h0.draw       <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> m.h0.bar, <span class="at">sd =</span> <span class="fu">sqrt</span>(V.h0.bar))</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>h0        <span class="ot">=</span> h0.draw</span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling sigma.v2</span></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>      sigma.v2.s    <span class="ot">=</span> sigmav.s <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">c</span>(aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">-</span> aux<span class="sc">$</span>h0, <span class="fu">diff</span>(aux<span class="sc">$</span>H))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>      sigma.v2.draw <span class="ot">=</span> sigma.v2.s <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, sigmav.nu <span class="sc">+</span> T)</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>sigma.v2  <span class="ot">=</span> sigma.v2.draw</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling auxiliary states</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>      Pr.tmp        <span class="ot">=</span> <span class="fu">simplify2array</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(x){</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dnorm</span>(Y.tilde, <span class="at">mean =</span> <span class="fu">as.vector</span>(aux<span class="sc">$</span>H <span class="sc">+</span> alpha.st[x]), <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma.st[x]), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">log</span>(pi.st[x])</span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>      }))</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>      Pr            <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr.tmp, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)))}))</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>      s.cum         <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr, <span class="dv">1</span>, cumsum))</span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>      r             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">runif</span>(T), <span class="dv">10</span>), <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>      ss            <span class="ot">=</span> <span class="fu">apply</span>(s.cum <span class="sc">&lt;</span> r, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>s         <span class="ot">=</span> <span class="fu">as.matrix</span>(ss)</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sampling log-volatilities using functions for tridiagonal precision matrix</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>      Sigma.s.inv   <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>      D.inv         <span class="ot">=</span> Sigma.s.inv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2) <span class="sc">*</span> HH</span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>      b             <span class="ot">=</span> <span class="fu">as.matrix</span>(Ytilde.alpha <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)] <span class="sc">+</span> (aux<span class="sc">$</span>h0<span class="sc">/</span>aux<span class="sc">$</span>sigma.v2)<span class="sc">*</span><span class="fu">diag</span>(T)[,<span class="dv">1</span>])</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>      lead.diag     <span class="ot">=</span> <span class="fu">diag</span>(D.inv)</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>      sub.diag      <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.inv, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>      D.chol        <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">trichol</span>(<span class="at">ld =</span> lead.diag, <span class="at">sd =</span> sub.diag)</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>      D.L           <span class="ot">=</span> <span class="fu">diag</span>(D.chol<span class="sc">$</span>ld)</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>      mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.L,<span class="sc">-</span><span class="dv">1</span>) <span class="ot">=</span> D.chol<span class="sc">$</span>sd</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>      x             <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(T))</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>      a             <span class="ot">=</span> <span class="fu">forwardsolve</span>(D.L, b)</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>      draw          <span class="ot">=</span> <span class="fu">backsolve</span>(<span class="fu">t</span>(D.L), a <span class="sc">+</span> x)</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>H         <span class="ot">=</span> <span class="fu">as.matrix</span>(draw)</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>sigma2    <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">exp</span>(draw))</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>      <span class="co"># output list</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>H[,s]             <span class="ot">=</span> aux<span class="sc">$</span>H</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>sigma2[,s]        <span class="ot">=</span> aux<span class="sc">$</span>sigma2</span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>s[,s]             <span class="ot">=</span> aux<span class="sc">$</span>s</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>h0[s]             <span class="ot">=</span> aux<span class="sc">$</span>h0</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>sigma.v2[s]       <span class="ot">=</span> aux<span class="sc">$</span>sigma.v2</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>A[,,s]            <span class="ot">=</span> aux<span class="sc">$</span>A</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>Sigma[,,s]        <span class="ot">=</span> aux<span class="sc">$</span>Sigma</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>lambda[s]         <span class="ot">=</span> aux<span class="sc">$</span>lambda</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(posteriors)</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 12 Mean Values of A.posterior.ext.het.simu (head 11) </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.000252</td>
<td style="text-align: center;">-0.007865</td>
<td style="text-align: center;">0.000212</td>
<td style="text-align: center;">0.027115</td>
<td style="text-align: center;">-0.012747</td>
<td style="text-align: center;">-0.000052</td>
<td style="text-align: center;">-0.000221</td>
<td style="text-align: center;">-0.001247</td>
<td style="text-align: center;">0.002027</td>
<td style="text-align: center;">0.002272</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.000001</td>
<td style="text-align: center;">-0.000366</td>
<td style="text-align: center;">-0.000020</td>
<td style="text-align: center;">-0.000876</td>
<td style="text-align: center;">0.000513</td>
<td style="text-align: center;">0.000011</td>
<td style="text-align: center;">0.000107</td>
<td style="text-align: center;">0.000106</td>
<td style="text-align: center;">0.000033</td>
<td style="text-align: center;">0.000016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000098</td>
<td style="text-align: center;">0.986538</td>
<td style="text-align: center;">0.000009</td>
<td style="text-align: center;">0.005141</td>
<td style="text-align: center;">-0.000005</td>
<td style="text-align: center;">0.000045</td>
<td style="text-align: center;">0.000092</td>
<td style="text-align: center;">0.000025</td>
<td style="text-align: center;">-0.000095</td>
<td style="text-align: center;">-0.000162</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000025</td>
<td style="text-align: center;">-0.001978</td>
<td style="text-align: center;">1.000008</td>
<td style="text-align: center;">0.002028</td>
<td style="text-align: center;">-0.000801</td>
<td style="text-align: center;">0.000011</td>
<td style="text-align: center;">-0.000078</td>
<td style="text-align: center;">-0.000100</td>
<td style="text-align: center;">0.000271</td>
<td style="text-align: center;">0.000182</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000015</td>
<td style="text-align: center;">0.001287</td>
<td style="text-align: center;">0.000004</td>
<td style="text-align: center;">0.997608</td>
<td style="text-align: center;">-0.000298</td>
<td style="text-align: center;">0.000056</td>
<td style="text-align: center;">0.000173</td>
<td style="text-align: center;">0.000187</td>
<td style="text-align: center;">0.000091</td>
<td style="text-align: center;">-0.000070</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.000014</td>
<td style="text-align: center;">-0.000792</td>
<td style="text-align: center;">0.000007</td>
<td style="text-align: center;">-0.003017</td>
<td style="text-align: center;">0.999020</td>
<td style="text-align: center;">0.000015</td>
<td style="text-align: center;">0.000079</td>
<td style="text-align: center;">0.000121</td>
<td style="text-align: center;">0.000035</td>
<td style="text-align: center;">-0.000247</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000003</td>
<td style="text-align: center;">-0.000512</td>
<td style="text-align: center;">-0.000049</td>
<td style="text-align: center;">-0.003216</td>
<td style="text-align: center;">0.002092</td>
<td style="text-align: center;">0.999965</td>
<td style="text-align: center;">0.000109</td>
<td style="text-align: center;">0.000448</td>
<td style="text-align: center;">0.000071</td>
<td style="text-align: center;">-0.000158</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000013</td>
<td style="text-align: center;">0.001064</td>
<td style="text-align: center;">0.000004</td>
<td style="text-align: center;">-0.000501</td>
<td style="text-align: center;">-0.000473</td>
<td style="text-align: center;">0.000063</td>
<td style="text-align: center;">0.999444</td>
<td style="text-align: center;">0.000047</td>
<td style="text-align: center;">-0.000228</td>
<td style="text-align: center;">-0.000015</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000005</td>
<td style="text-align: center;">0.003131</td>
<td style="text-align: center;">-0.000011</td>
<td style="text-align: center;">-0.000572</td>
<td style="text-align: center;">0.001112</td>
<td style="text-align: center;">0.000002</td>
<td style="text-align: center;">0.000075</td>
<td style="text-align: center;">0.999049</td>
<td style="text-align: center;">0.000380</td>
<td style="text-align: center;">0.000389</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.000003</td>
<td style="text-align: center;">0.002141</td>
<td style="text-align: center;">0.000056</td>
<td style="text-align: center;">0.001817</td>
<td style="text-align: center;">-0.002415</td>
<td style="text-align: center;">0.000078</td>
<td style="text-align: center;">0.000401</td>
<td style="text-align: center;">0.000702</td>
<td style="text-align: center;">0.999398</td>
<td style="text-align: center;">-0.000297</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.000021</td>
<td style="text-align: center;">0.000206</td>
<td style="text-align: center;">-0.000002</td>
<td style="text-align: center;">-0.001143</td>
<td style="text-align: center;">0.000835</td>
<td style="text-align: center;">0.000076</td>
<td style="text-align: center;">0.000157</td>
<td style="text-align: center;">0.000360</td>
<td style="text-align: center;">-0.000684</td>
<td style="text-align: center;">0.999405</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-bordered table-sm small" data-quarto-postprocess="true">
<caption>Table 13 Mean Values of Sigma.posterior.ext.het.simu </caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.275540</td>
<td style="text-align: center;">-0.041653</td>
<td style="text-align: center;">0.001046</td>
<td style="text-align: center;">0.012248</td>
<td style="text-align: center;">-0.018893</td>
<td style="text-align: center;">-0.018474</td>
<td style="text-align: center;">-0.010136</td>
<td style="text-align: center;">-0.017104</td>
<td style="text-align: center;">-0.018711</td>
<td style="text-align: center;">-0.000970</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.041653</td>
<td style="text-align: center;">10.975668</td>
<td style="text-align: center;">-0.007855</td>
<td style="text-align: center;">0.222756</td>
<td style="text-align: center;">-0.093862</td>
<td style="text-align: center;">-0.049361</td>
<td style="text-align: center;">0.024519</td>
<td style="text-align: center;">0.054310</td>
<td style="text-align: center;">-0.042337</td>
<td style="text-align: center;">-0.094923</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.001046</td>
<td style="text-align: center;">-0.007855</td>
<td style="text-align: center;">0.255115</td>
<td style="text-align: center;">-0.006483</td>
<td style="text-align: center;">-0.034965</td>
<td style="text-align: center;">-0.014513</td>
<td style="text-align: center;">-0.030686</td>
<td style="text-align: center;">-0.031307</td>
<td style="text-align: center;">-0.007830</td>
<td style="text-align: center;">0.007857</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.012248</td>
<td style="text-align: center;">0.222756</td>
<td style="text-align: center;">-0.006483</td>
<td style="text-align: center;">3.867807</td>
<td style="text-align: center;">-0.635111</td>
<td style="text-align: center;">-0.021468</td>
<td style="text-align: center;">-0.013437</td>
<td style="text-align: center;">-0.035502</td>
<td style="text-align: center;">-0.103880</td>
<td style="text-align: center;">0.056191</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.018893</td>
<td style="text-align: center;">-0.093862</td>
<td style="text-align: center;">-0.034965</td>
<td style="text-align: center;">-0.635111</td>
<td style="text-align: center;">1.741754</td>
<td style="text-align: center;">-0.030176</td>
<td style="text-align: center;">-0.078000</td>
<td style="text-align: center;">-0.103964</td>
<td style="text-align: center;">-0.006168</td>
<td style="text-align: center;">-0.051384</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.018474</td>
<td style="text-align: center;">-0.049361</td>
<td style="text-align: center;">-0.014513</td>
<td style="text-align: center;">-0.021468</td>
<td style="text-align: center;">-0.030176</td>
<td style="text-align: center;">0.270740</td>
<td style="text-align: center;">-0.021698</td>
<td style="text-align: center;">-0.040671</td>
<td style="text-align: center;">-0.001876</td>
<td style="text-align: center;">-0.013299</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.010136</td>
<td style="text-align: center;">0.024519</td>
<td style="text-align: center;">-0.030686</td>
<td style="text-align: center;">-0.013437</td>
<td style="text-align: center;">-0.078000</td>
<td style="text-align: center;">-0.021698</td>
<td style="text-align: center;">0.300222</td>
<td style="text-align: center;">-0.019059</td>
<td style="text-align: center;">-0.027454</td>
<td style="text-align: center;">-0.004833</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.017104</td>
<td style="text-align: center;">0.054310</td>
<td style="text-align: center;">-0.031307</td>
<td style="text-align: center;">-0.035502</td>
<td style="text-align: center;">-0.103964</td>
<td style="text-align: center;">-0.040671</td>
<td style="text-align: center;">-0.019059</td>
<td style="text-align: center;">0.368813</td>
<td style="text-align: center;">-0.080267</td>
<td style="text-align: center;">-0.031458</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.018711</td>
<td style="text-align: center;">-0.042337</td>
<td style="text-align: center;">-0.007830</td>
<td style="text-align: center;">-0.103880</td>
<td style="text-align: center;">-0.006168</td>
<td style="text-align: center;">-0.001876</td>
<td style="text-align: center;">-0.027454</td>
<td style="text-align: center;">-0.080267</td>
<td style="text-align: center;">0.400136</td>
<td style="text-align: center;">0.032739</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.000970</td>
<td style="text-align: center;">-0.094923</td>
<td style="text-align: center;">0.007857</td>
<td style="text-align: center;">0.056191</td>
<td style="text-align: center;">-0.051384</td>
<td style="text-align: center;">-0.013299</td>
<td style="text-align: center;">-0.004833</td>
<td style="text-align: center;">-0.031458</td>
<td style="text-align: center;">0.032739</td>
<td style="text-align: center;">0.310357</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Histograms Trace Plots Extended Hetero-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 16 Histograms and trace plots on key variables using extended hetero model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Applying heteroscedasticity to the expanded model, we observe markedly aggressive results (similar to the comparison between the expanded and standard models). Figure 17 illustrates that under the extended model, the forecast for the next eight periods of inflation again shows negative inflation, with an even greater degree of deflation. Although the model’s predictions of ‘people’s expectations of inflation’ remain relatively stable, these results are not acceptable considering our understanding.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Extended Model with hetero Key Data Plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 17 Extended model with heteroskedasticity key data plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="heteroskadasticity-analysis" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="heteroskadasticity-analysis"><span class="header-section-number">6.3</span> Heteroskadasticity Analysis</h3>
<p>Notably, in Figure 18 both models exhibit signs of heteroscedasticity around the time point 120 (Year 2020), where there is a sharp increase in sigma squared values.</p>
<p>More specifically, the “sigma2.basic” model (black line) shows a more pronounced increase in sigma squared values around time point 120 compared to the “sigma2.heter” model (blue line). This suggests that the basic model may be more sensitive or effective in capturing the variance anomalies at this juncture. This enhanced sensitivity could be attributed to differences in the internal parameter settings or data handling methodologies of the models. Thus, it can be inferred that although both models are capable of detecting heteroscedasticity within the data, the “sigma2.basic” model may exhibit superior performance in accommodating periods of high volatility. This observation might indicate that the settings of the basic model are better suited for capturing extreme fluctuations, thereby suggesting that the “sigma2.basic” model is potentially more robust in such scenarios.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Sigma2Plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 18 Sigma2 time series plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">7</span> Conclusion</h2>
<p>In this research, we analyzed four Bayesian Vector Autoregression (VAR) models aimed at forecasting inflation and people’s expectations of inflation. Beginning with a basic model featuring a simple Minnesota prior to capture the characteristics and dynamic relationships observed in the variables, we constructed a hierarchical model by implementing the Minnesota shrinkage hyperparameter <span class="math inline">\(\lambda\)</span>. Building on the basic model, we introduced stochastic volatility to enhance the model’s performance. We conducted an 8-step ahead forecast for each model and compared the results.</p>
<p>Overall, all four models predicted a downward trend in Australia’s inflation rate. The decline was quite pronounced without considering heteroscedasticity; however, with heteroscedasticity accounted for, the basic model’s smooth decline to 2-3% was most in line with expectations. In contrast, the application of heteroscedasticity in the extended model did not perform as well.</p>
</section>
<section id="references" class="level2 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-bernoth2021" class="csl-entry" role="listitem">
Bernoth, Kerstin, and Gökhan Ider. 2021. <span>“Inflation in the Euro Area: Factors Mostly Have Only a Temporary Effect, but Risk of Prolonged Elevated Inflation Remains.”</span> <em>DIW Weekly Report</em>. <a href="https://doi.org/10.18723/DIW_DWR:2021-41-1">https://doi.org/10.18723/DIW_DWR:2021-41-1</a>.
</div>
<div id="ref-EuropeanParliament.2022" class="csl-entry" role="listitem">
European Parliament. Directorate General for Internal Policies of the Union. 2022. <em>Inflation expectations in the euro area: trends and policy considerations : monetary dialogue papers : February 2022.</em> LU: Publications Office. <a href="https://doi.org/10.2861/744032">https://doi.org/10.2861/744032</a>.
</div>
<div id="ref-kalemli-ozcan2020" class="csl-entry" role="listitem">
Kalemli-Ozcan, Sebnem, Pierre-Olivier Gourinchas, Veronika Penciakova, and Nick Sander. 2020. <span>“COVID-19 and SME Failures.”</span> <em>IMF Working Papers</em> 2020 (207): 1. <a href="https://doi.org/10.5089/9781513557748.001">https://doi.org/10.5089/9781513557748.001</a>.
</div>
<div id="ref-stock2001" class="csl-entry" role="listitem">
Stock, James H, and Mark W Watson. 2001. <span>“Vector Autoregressions.”</span> <em>Journal of Economic Perspectives</em> 15 (4): 101–15. <a href="https://doi.org/10.1257/jep.15.4.101">https://doi.org/10.1257/jep.15.4.101</a>.
</div>
<div id="ref-wozniak2023" class="csl-entry" role="listitem">
WOZNIAK, TOMASZ. 2023. <span>“Bayesian Autoregression.”</span> <a href="https://doi.org/10.26188/23255657">https://doi.org/10.26188/23255657</a>.
</div>
<div id="ref-wozniak2016" class="csl-entry" role="listitem">
Woźniak, Tomasz. 2016. <span>“Bayesian Vector Autoregressions.”</span> <em>Australian Economic Review</em> 49 (3): 365–80. <a href="https://doi.org/10.1111/1467-8462.12179">https://doi.org/10.1111/1467-8462.12179</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>